<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BIMS - SK Official Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="css/responsive.css" />
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#2f6e4e",
              secondary: "#3d8b64",
            },
            fontFamily: {
              sans: ["Inter", "system-ui", "sans-serif"],
            },
          },
        },
      };
    </script>
    <style>
      /* Enhanced Icon System */
      .icon-wrapper {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .icon-wrapper:hover {
        transform: translateY(-2px);
      }
      .nav-link svg {
        transition: all 0.3s ease;
      }
      .nav-link:hover svg {
        transform: scale(1.1);
      }
      .icon-badge {
        box-shadow: 0 2px 8px rgba(47, 110, 78, 0.15);
      }
      .notification-icon {
        position: relative;
      }
      .notification-icon:hover {
        transform: rotate(15deg) scale(1.1);
        transition: transform 0.3s ease;
      }
      .status-icon-pending {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
      }
      .status-icon-approved {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      }
      .status-icon-rejected {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      }
      .icon-primary {
        filter: drop-shadow(0 2px 4px rgba(47, 110, 78, 0.1));
      }
      .icon-glow {
        filter: drop-shadow(0 0 8px rgba(47, 110, 78, 0.3));
      }

      /* Toast Notification Styles */
      .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        min-width: 300px;
        background: white;
        padding: 16px 20px;
        border-radius: 12px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        gap: 12px;
        transform: translateX(400px);
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 9999;
      }

      .toast.show {
        transform: translateX(0);
      }

      .toast.success {
        border-left: 4px solid #10b981;
      }

      .toast.error {
        border-left: 4px solid #ef4444;
      }

      .toast.warning {
        border-left: 4px solid #f59e0b;
      }

      .toast.info {
        border-left: 4px solid #3b82f6;
      }

      /* Input validation states */
      .input-error {
        border-color: #ef4444 !important;
        background-color: #fef2f2 !important;
      }

      .input-success {
        border-color: #10b981 !important;
      }

      /* Loading spinner */
      .spinner {
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top-color: white;
        border-radius: 50%;
        width: 16px;
        height: 16px;
        animation: spin 0.6s linear infinite;
      }

      @keyframes spin {
        to { transform: rotate(360deg); }
      }

      /* Character counter */
      .char-counter {
        font-size: 0.75rem;
        color: #6b7280;
        text-align: right;
        margin-top: 0.25rem;
      }

      .char-counter.warning {
        color: #f59e0b;
      }

      .char-counter.error {
        color: #ef4444;
      }

      /* Pagination dots - consistent across all screen sizes */
      #announcementPaginationDots button {
        flex-shrink: 0;
        display: inline-block;
        cursor: pointer;
        border: none;
        padding: 0;
        outline: none;
      }

      #announcementPaginationDots button:focus {
        outline: 2px solid rgba(47, 110, 78, 0.3);
        outline-offset: 2px;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <div class="flex h-screen overflow-hidden">
      <!-- Sidebar Navigation -->
      <aside
        class="w-64 bg-white shadow-lg flex-shrink-0 h-screen flex flex-col"
      >
        <div class="p-6 flex-1 flex flex-col">
          <!-- Logo -->
          <div class="flex items-center space-x-4 mb-8">
            <div
              class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-lg icon-badge overflow-hidden"
            >
              <img src="asset/logo.svg" alt="BIMS Logo" class="w-full h-full object-contain p-1">
            </div>
            <div>
              <h1 class="text-xl font-black text-gray-800">BIMS</h1>
              <p class="text-sm text-gray-600 font-medium">SK Malanday</p>
            </div>
          </div>

          <!-- Navigation Menu -->
          <nav class="space-y-2">
            <a
              href="sk-dashboard.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 bg-[#2f6e4e]/10 text-[#2f6e4e] rounded-lg font-medium group"
            >
              <div class="w-9 h-9 bg-[#2f6e4e]/20 rounded-lg flex items-center justify-center group-hover:bg-[#2f6e4e]/30 transition">
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2.5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3"
                  ></path>
                </svg>
              </div>
              <span>Dashboard</span>
            </a>
            <a
              href="sk-files.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-blue-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-blue-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  ></path>
                </svg>
              </div>
              <span>Manage Files</span>
            </a>
            <a
              href="sk-projects.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-purple-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-purple-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                  ></path>
                </svg>
              </div>
              <span>Project Monitoring</span>
            </a>
            <a
              href="sk-calendar.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-orange-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-orange-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                  ></path>
                </svg>
              </div>
              <span>Calendar</span>
            </a>
            <a
              href="sk-testimonies.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-indigo-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-indigo-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
                  ></path>
                </svg>
              </div>
              <span>Testimonies</span>
            </a>
            <a
              href="sk-archive.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition">
                <svg
                  class="w-5 h-5 group-hover:text-gray-700 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"
                  ></path>
                </svg>
              </div>
              <span>Archives</span>
            </a>
          </nav>

          <div class="flex-1"></div>

          <!-- Logout -->
          <div class="mt-8 pt-8 border-t border-gray-200">
            <button
              class="nav-link flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition w-full group"
            >
              <div class="w-9 h-9 bg-red-50 rounded-lg flex items-center justify-center group-hover:bg-red-100 transition">
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                  ></path>
                </svg>
              </div>
              <span class="font-medium">Logout</span>
            </button>
          </div>
        </div>
      </aside>

      <!-- Confirmation Modal -->
      <div id="confirmModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[10000] flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl max-w-md w-full p-6 transform transition-all">
          <div class="flex items-center justify-center w-12 h-12 mx-auto bg-yellow-100 rounded-full mb-4">
            <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
            </svg>
          </div>
          <h3 id="confirmTitle" class="text-lg font-bold text-gray-900 text-center mb-2">Confirm Action</h3>
          <p id="confirmMessage" class="text-sm text-gray-600 text-center mb-6">Are you sure you want to proceed?</p>
          <div class="flex gap-3">
            <button id="confirmCancel" class="flex-1 px-4 py-2.5 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-medium text-gray-700">Cancel</button>
            <button id="confirmOk" class="flex-1 px-4 py-2.5 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition font-medium">Confirm</button>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="flex-1 overflow-auto">
        <!-- Top Bar -->
        <header class="bg-gradient-to-r from-[#2f6e4e]/10 to-white border-b border-gray-200">
          <div class="px-8 py-6">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-[#2f6e4e] font-semibold mb-1" id="currentDate">Sunday, December 14, 2025</p>
                <h1 class="text-2xl font-bold text-gray-800">Dashboard</h1>
                <p class="text-sm text-gray-600 mt-1">Overview of barangay activities, projects, and volunteer engagement</p>
              </div>
              <div class="flex items-center space-x-4">
                <div class="relative">
                  <button onclick="toggleNotificationModal()" class="notification-icon p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition" title="Notifications">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                    </svg>
                    <span id="notificationBadge" class="hidden absolute -top-1 -right-1 bg-gradient-to-br from-red-500 to-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center shadow-lg shadow-red-500/50 animate-pulse">5</span>
                  </button>
                </div>
                <div class="flex items-center space-x-3 cursor-pointer hover:bg-gray-50 rounded-xl px-3 py-2 transition-all duration-300 group" onclick="openProfileModal()">
                  <div class="text-right">
                    <p class="text-sm font-medium text-gray-700 group-hover:text-[#2f6e4e] transition">Andrea Pelias</p>
                    <p class="text-xs text-gray-500">SK Chairman</p>
                  </div>
                  <div class="w-10 h-10 bg-gradient-to-br from-[#2f6e4e] to-[#3d8b64] rounded-full flex items-center justify-center text-white font-semibold shadow-lg ring-2 ring-[#2f6e4e]/20 group-hover:ring-[#2f6e4e]/40 transition">
                    AP
                  </div>
                </div>
              </div>
            </div>
          </div>
        </header>

        <!-- Stats Cards -->
        <div class="px-6 py-6">
          <div class="max-w-7xl mx-auto">
            <div
              class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"
            >
              <!-- Total Files -->
              <div class="group bg-gradient-to-br from-blue-50 to-white rounded-2xl shadow-md hover:shadow-xl p-6 border-l-4 border-blue-500 transition-all duration-300 hover:-translate-y-1 cursor-pointer">
                <div class="flex items-start justify-between mb-3">
                  <div class="w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                  </div>
                </div>
                <p class="text-sm text-gray-600 font-semibold uppercase tracking-wide mb-1">Total Files</p>
                <p class="text-4xl font-extrabold text-gray-900 mb-1">156</p>
                <p class="text-xs text-gray-500">Uploaded documents</p>
              </div>

              <!-- Total Announcements -->
              <div class="group bg-gradient-to-br from-amber-50 to-white rounded-2xl shadow-md hover:shadow-xl p-6 border-l-4 border-amber-500 transition-all duration-300 hover:-translate-y-1 cursor-pointer">
                <div class="flex items-start justify-between mb-3">
                  <div class="w-14 h-14 bg-gradient-to-br from-amber-500 to-amber-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"></path>
                    </svg>
                  </div>
                </div>
                <p class="text-sm text-gray-600 font-semibold uppercase tracking-wide mb-1">Announcements</p>
                <p class="text-4xl font-extrabold text-gray-900 mb-1">42</p>
                <p class="text-xs text-gray-500">Active posts</p>
              </div>

              <!-- Active Projects -->
              <div class="group bg-gradient-to-br from-green-50 to-white rounded-2xl shadow-md hover:shadow-xl p-6 border-l-4 border-[#2f6e4e] transition-all duration-300 hover:-translate-y-1 cursor-pointer">
                <div class="flex items-start justify-between mb-3">
                  <div class="w-14 h-14 bg-gradient-to-br from-[#2f6e4e] to-[#3d8b64] rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                  </div>
                </div>
                <p class="text-sm text-gray-600 font-semibold uppercase tracking-wide mb-1">Active Projects</p>
                <p class="text-4xl font-extrabold text-gray-900 mb-1">18</p>
                <p class="text-xs text-gray-500 flex items-center gap-1">
                  <svg class="w-3 h-3 text-green-500" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                  Ongoing initiatives
                </p>
              </div>

              <!-- Youth Volunteers -->
              <div class="group bg-gradient-to-br from-purple-50 to-white rounded-2xl shadow-md hover:shadow-xl p-6 border-l-4 border-purple-500 transition-all duration-300 hover:-translate-y-1 cursor-pointer">
                <div class="flex items-start justify-between mb-3">
                  <div class="w-14 h-14 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2.5">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                    </svg>
                  </div>
                </div>
                <p class="text-sm text-gray-600 font-semibold uppercase tracking-wide mb-1">Youth Volunteers</p>
                <p class="text-4xl font-extrabold text-gray-900 mb-1">328</p>
                <p class="text-xs text-gray-500 flex items-center gap-1">
                  <svg class="w-3 h-3 text-purple-500" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M5.293 7.707a1 1 0 010-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L6.707 7.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                  </svg>
                  Registered members
                </p>
              </div>
            </div>

            <!-- Latest Announcements Section -->
            <div class="bg-white rounded-xl shadow-sm p-6 mb-6">
              <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between mb-6">
                <h3 class="text-xl font-bold text-gray-800">
                  Manage Announcements
                </h3>
                <button
                  onclick="openCreateModal()"
                  class="w-full md:w-auto bg-[#2f6e4e] hover:bg-[#2f6e4e] text-white px-4 py-2 rounded-lg font-medium transition flex items-center space-x-2 md:min-w-[180px] justify-center"
                >
                  <svg
                    class="w-5 h-5"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 4v16m8-8H4"
                    ></path>
                  </svg>
                  <span>Create New Announcement</span>
                </button>
              </div>

              <div id="announcementsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Announcements will be dynamically inserted here -->
                <!-- Announcement Card 1 -->
                <div
                  class="border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition"
                >
                  <div
                    class="h-32 bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center"
                  >
                    <svg
                      class="w-16 h-16 text-white"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                      ></path>
                    </svg>
                  </div>
                  <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                      <span
                        class="px-3 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full"
                        >urgent</span
                      >
                      <span class="text-xs text-gray-500">Nov 18, 2025</span>
                    </div>
                    <h4 class="text-lg font-bold text-gray-800 mb-2">
                      Youth Sports Festival 2025
                    </h4>
                    <p class="text-sm text-gray-600 mb-3">
                      Join us for an exciting sports festival featuring
                      basketball, volleyball, and more!
                    </p>
                    <div class="flex justify-end">
                      <div class="flex space-x-2">
                        <button
                          onclick="viewAnnouncement(1)"
                          class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition"
                          title="View"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                            ></path>
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                            ></path>
                          </svg>
                        </button>
                        <button
                          onclick="openEditModal(1)"
                          class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition"
                          title="Edit"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                            ></path>
                          </svg>
                        </button>
                        <button
                          onclick="confirmDelete(1)"
                          class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition"
                          title="Delete"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                            ></path>
                          </svg>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Announcement Card 2 -->
                <div
                  class="border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition"
                >
                  <div
                    class="h-32 bg-gradient-to-br from-blue-400 to-blue-500 flex items-center justify-center"
                  >
                    <svg
                      class="w-16 h-16 text-white"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
                      ></path>
                    </svg>
                  </div>
                  <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                      <span
                        class="px-3 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full"
                        >general</span
                      >
                      <span class="text-xs text-gray-500">Nov 25, 2025</span>
                    </div>
                    <h4 class="text-lg font-bold text-gray-800 mb-2">
                      Free Skills Training Workshop
                    </h4>
                    <p class="text-sm text-gray-600 mb-3">
                      Learn digital marketing, graphic design, and basic
                      programming.
                    </p>
                    <div class="flex justify-end">
                      <div class="flex space-x-2">
                        <button
                          onclick="viewAnnouncement(2)"
                          class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition"
                          title="View"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                            ></path>
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                            ></path>
                          </svg>
                        </button>
                        <button
                          onclick="openEditModal(2)"
                          class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition"
                          title="Edit"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                            ></path>
                          </svg>
                        </button>
                        <button
                          onclick="confirmDelete(2)"
                          class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition"
                          title="Delete"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                            ></path>
                          </svg>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Announcement Card 3 -->
                <div
                  class="border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition"
                >
                  <div
                    class="h-32 bg-gradient-to-br from-green-400 to-green-500 flex items-center justify-center"
                  >
                    <svg
                      class="w-16 h-16 text-white"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                      ></path>
                    </svg>
                  </div>
                  <div class="p-5">
                    <div class="flex items-center justify-between mb-3">
                      <span
                        class="px-3 py-1 bg-[#2f6e4e]/20 text-[#2f6e4e] text-xs font-medium rounded-full"
                        >update</span
                      >
                      <span class="text-xs text-gray-500">Nov 15, 2025</span>
                    </div>
                    <h4 class="text-lg font-bold text-gray-800 mb-2">
                      Scholarship Program Now Open
                    </h4>
                    <p class="text-sm text-gray-600 mb-3">
                      Applications are now being accepted. Deadline: December
                      15, 2025.
                    </p>
                    <div class="flex justify-end">
                      <div class="flex space-x-2">
                        <button
                          onclick="viewAnnouncement(3)"
                          class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition"
                          title="View"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
                            ></path>
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                            ></path>
                          </svg>
                        </button>
                        <button
                          onclick="openEditModal(3)"
                          class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition"
                          title="Edit"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                            ></path>
                          </svg>
                        </button>
                        <button
                          onclick="confirmDelete(3)"
                          class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition"
                          title="Delete"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                            ></path>
                          </svg>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Pagination Dots (Center) -->
              <div id="announcementPaginationDots" class="flex justify-center gap-2 mt-6 hidden">
                <!-- Dots will be inserted here -->
              </div>

              <!-- Pagination Controls (Bottom Right) -->
              <div class="mt-6 flex justify-end">
                <nav
                  id="announcementPaginationNav"
                  class="hidden inline-flex rounded-md shadow-sm"
                  role="navigation"
                  aria-label="Pagination"
                >
                  <button
                    id="prevAnnouncementPage"
                    onclick="navigateAnnouncements(-1)"
                    class="px-3 py-2 border border-gray-200 rounded-l-md hover:bg-gray-50 transition text-gray-700 font-medium"
                  >
                    Prev
                  </button>
                  <button
                    id="nextAnnouncementPage"
                    onclick="navigateAnnouncements(1)"
                    class="px-3 py-2 border-t border-b border-r border-gray-200 rounded-r-md hover:bg-gray-50 transition text-gray-700 font-medium"
                  >
                    Next
                  </button>
                </nav>
              </div>
            </div>

            <!-- Transparency & Budget Reports Section -->
            <div class="mt-8">
              <h2 class="text-2xl font-bold text-gray-800 mb-2">Transparency & Budget Reports</h2>
              <p class="text-gray-600 mb-6">Full transparency on how your barangay funds are utilized</p>

              <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- 2025 Budget Allocation -->
                <div class="bg-gradient-to-br from-blue-50 to-white rounded-xl shadow-sm p-6 border border-blue-100">
                  <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-bold text-gray-800" id="budgetYearTitle">2025 Budget Allocation</h3>
                    <div class="flex space-x-2">
                      <button onclick="editBudgetAllocation()" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition" title="Edit Budget">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                      </button>
                      <button onclick="viewBudgetHistory()" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition" title="View History">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                      </button>
                    </div>
                  </div>

                  <div class="space-y-4">
                    <!-- Youth Development Programs -->
                    <div>
                      <div class="flex justify-between text-sm mb-1">
                        <span class="text-gray-700 font-medium">Youth Development Programs</span>
                        <span class="text-gray-900 font-semibold" id="youthBudget">₱450,000</span>
                      </div>
                      <div class="w-full bg-blue-100 rounded-full h-2">
                        <div id="youthBudgetBar" class="bg-blue-600 h-2 rounded-full" style="width: 45%"></div>
                      </div>
                    </div>

                    <!-- Community Events -->
                    <div>
                      <div class="flex justify-between text-sm mb-1">
                        <span class="text-gray-700 font-medium">Community Events</span>
                        <span class="text-gray-900 font-semibold" id="eventsBudget">₱300,000</span>
                      </div>
                      <div class="w-full bg-blue-100 rounded-full h-2">
                        <div id="eventsBudgetBar" class="bg-blue-600 h-2 rounded-full" style="width: 30%"></div>
                      </div>
                    </div>

                    <!-- Infrastructure Projects -->
                    <div>
                      <div class="flex justify-between text-sm mb-1">
                        <span class="text-gray-700 font-medium">Infrastructure Projects</span>
                        <span class="text-gray-900 font-semibold" id="infraBudget">₱250,000</span>
                      </div>
                      <div class="w-full bg-blue-100 rounded-full h-2">
                        <div id="infraBudgetBar" class="bg-blue-600 h-2 rounded-full" style="width: 25%"></div>
                      </div>
                    </div>

                    <!-- Total Budget -->
                    <div class="pt-4 border-t border-blue-200 flex justify-between">
                      <span class="text-gray-800 font-bold">Total Budget</span>
                      <span class="text-2xl font-bold text-blue-600" id="totalBudget">₱1,000,000</span>
                    </div>
                  </div>
                </div>

                <!-- Project Success Metrics -->
                <div class="bg-gradient-to-br from-[#2f6e4e]/10 to-white rounded-xl shadow-sm p-6 border border-[#2f6e4e]/20">
                  <div class="flex items-center justify-between mb-4">
                    <div>
                      <h3 class="text-lg font-bold text-gray-800">Project Success Metrics</h3>
                      <p class="text-sm text-gray-600">Based on 5-factor evaluation system</p>
                    </div>
                    <div class="p-3 bg-[#2f6e4e]/20 rounded-lg">
                      <svg class="w-6 h-6 text-[#2f6e4e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                      </svg>
                    </div>
                  </div>

                  <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="text-center p-4 bg-white rounded-lg border border-[#2f6e4e]/20">
                      <p class="text-3xl font-bold text-[#2f6e4e]" id="totalProjects">42</p>
                      <p class="text-sm text-gray-600 mt-1">Total Projects</p>
                      <p class="text-xs text-gray-400 mt-1" id="projectsYear">2025</p>
                    </div>
                    <div class="text-center p-4 bg-white rounded-lg border border-[#2f6e4e]/20">
                      <p class="text-3xl font-bold text-[#2f6e4e]" id="completedProjects">38</p>
                      <p class="text-sm text-gray-600 mt-1">Completed</p>
                    </div>
                    <div class="text-center p-4 bg-white rounded-lg border border-[#2f6e4e]/20">
                      <p class="text-3xl font-bold text-yellow-600" id="ongoingProjects">4</p>
                      <p class="text-sm text-gray-600 mt-1">Ongoing</p>
                    </div>
                    <div class="text-center p-4 bg-white rounded-lg border border-[#2f6e4e]/20">
                      <p class="text-3xl font-bold text-[#2f6e4e]" id="successRate">89%</p>
                      <p class="text-sm text-gray-600 mt-1">Avg Success Rate</p>
                    </div>
                  </div>

                  <div class="bg-white rounded-lg border border-[#2f6e4e]/20 p-4">
                    <p class="text-xs font-semibold text-gray-700 mb-2">Success Rate Calculation:</p>
                    <div class="grid grid-cols-2 gap-2 text-xs text-gray-600">
                      <div>• Budget Efficiency (25%)</div>
                      <div>• Timeline Adherence (20%)</div>
                      <div>• Volunteer Participation (20%)</div>
                      <div>• Volunteer Feedback (15%)</div>
                      <div>• Community Impact (20%)</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Announcement Modal -->
    <div
      id="createModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
      >
        <div class="p-6 border-b border-gray-200">
          <div class="flex items-center justify-between">
            <h3 class="text-2xl font-bold text-gray-800">
              Create New Announcement
            </h3>
            <button
              onclick="closeCreateModal()"
              class="text-gray-400 hover:text-gray-600 transition"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="p-6 space-y-4">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Title *</label
            >
            <input
              type="text"
              id="createTitle"
              placeholder="Enter announcement title"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
            />
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Category *</label
            >
            <select
              id="createCategory"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
            >
              <option value="">Select category</option>
              <option value="urgent">Urgent</option>
              <option value="general">General</option>
              <option value="update">Update</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Description *</label
            >
            <textarea
              id="createDescription"
              rows="5"
              maxlength="500"
              placeholder="Enter announcement description"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
              oninput="updateCharCount('createDescription', 'createDescCharCount', 500)"
            ></textarea>
            <div id="createDescCharCount" class="char-counter">0/500 characters</div>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Image (Optional, Max 5MB)</label
            >
            <input
              type="file"
              id="createImage"
              accept="image/*"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
            />
            <p class="text-xs text-gray-500 mt-1">
              Accepted formats: JPG, PNG, GIF
            </p>
          </div>
        </div>
        <div class="p-6 border-t border-gray-200 flex justify-end space-x-3">
          <button
            onclick="closeCreateModal()"
            class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-medium"
          >
            Cancel
          </button>
          <button
            onclick="postAnnouncement()"
            class="px-6 py-3 bg-[#2f6e4e] hover:bg-[#2f6e4e] text-white rounded-lg transition font-medium"
          >
            Post Announcement
          </button>
        </div>
      </div>
    </div>

    <!-- Edit Announcement Modal -->
    <div
      id="editModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
      >
        <div class="p-6 border-b border-gray-200">
          <div class="flex items-center justify-between">
            <h3 class="text-2xl font-bold text-gray-800">Edit Announcement</h3>
            <button
              onclick="closeEditModal()"
              class="text-gray-400 hover:text-gray-600 transition"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="p-6 space-y-4">
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Title *</label
            >
            <input
              type="text"
              id="editTitle"
              placeholder="Enter announcement title"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
            />
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Category *</label
            >
            <select
              id="editCategory"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
            >
              <option value="">Select category</option>
              <option value="urgent">Urgent</option>
              <option value="general">General</option>
              <option value="update">Update</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Description *</label
            >
            <textarea
              id="editDescription"
              rows="5"
              maxlength="500"
              placeholder="Enter announcement description"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
              oninput="updateCharCount('editDescription', 'editDescCharCount', 500)"
            ></textarea>
            <div id="editDescCharCount" class="char-counter">0/500 characters</div>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Change Image (Optional, Max 5MB)</label
            >
            <input
              type="file"
              id="editImage"
              accept="image/*"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
            />
            <p class="text-xs text-gray-500 mt-1">
              Leave empty to keep current image
            </p>
          </div>
        </div>
        <div class="p-6 border-t border-gray-200 flex justify-end space-x-3">
          <button
            onclick="closeEditModal()"
            class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-medium"
          >
            Cancel
          </button>
          <button
            onclick="saveEdit()"
            class="px-6 py-3 bg-[#2f6e4e] hover:bg-[#2f6e4e] text-white rounded-lg transition font-medium"
          >
            Save Changes
          </button>
        </div>
      </div>
    </div>

    <!-- View Announcement Modal -->
    <div
      id="viewModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
      >
        <div class="p-6 border-b border-gray-200">
          <div class="flex items-center justify-between mb-3">
            <span
              id="viewCategory"
              class="px-3 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full"
              >urgent</span
            >
            <button
              onclick="closeViewModal()"
              class="text-gray-400 hover:text-gray-600 transition"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>
          <h3 class="text-2xl font-bold text-gray-800" id="viewTitle">
            Announcement Details
          </h3>
        </div>
        <div class="p-6 space-y-4">
          <div
            id="viewImage"
            class="h-64 bg-gradient-to-br from-orange-400 to-orange-500 rounded-lg flex items-center justify-center"
          >
            <svg
              class="w-24 h-24 text-white"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
              ></path>
            </svg>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Date Posted</label
            >
            <p id="viewDate" class="text-gray-600">November 18, 2025</p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Description</label
            >
            <p id="viewDescription" class="text-gray-600">
              Full announcement description will appear here...
            </p>
          </div>
        </div>
        <div class="p-6 border-t border-gray-200 flex justify-end">
          <button
            onclick="closeViewModal()"
            class="px-6 py-3 bg-[#2f6e4e] hover:bg-[#2f6e4e] text-white rounded-lg transition font-medium"
          >
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div
      id="deleteModal"
      class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"
    >
      <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
        <div class="p-6">
          <div
            class="flex items-center justify-center w-12 h-12 bg-red-100 rounded-full mx-auto mb-4"
          >
            <svg
              class="w-6 h-6 text-red-600"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
              ></path>
            </svg>
          </div>
          <h3 class="text-xl font-bold text-gray-800 text-center mb-2">
            Delete Announcement?
          </h3>
          <p class="text-gray-600 text-center mb-6">
            This action cannot be undone. Are you sure you want to permanently
            delete this announcement?
          </p>
          <div class="flex space-x-3">
            <button
              onclick="closeDeleteModal()"
              class="flex-1 px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-medium"
            >
              Cancel
            </button>
            <button
              onclick="deleteAnnouncement()"
              class="flex-1 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition font-medium"
            >
              Delete
            </button>
          </div>
        </div>
      </div>
    </div>


    <!-- Notification Modal -->
    <div
      id="notificationModal"
      class="hidden fixed top-20 right-6 w-96 bg-white rounded-xl shadow-2xl z-50 border border-gray-200"
    >
      <div
        class="p-4 border-b border-gray-200 flex items-center justify-between"
      >
        <h3 class="font-bold text-gray-800">Notifications</h3>
        <button
          onclick="markAllAsRead()"
          class="text-xs text-[#2f6e4e] hover:text-[#2f6e4e] font-medium"
        >
          Mark all as read
        </button>
      </div>
      <div id="notificationList" class="max-h-96 overflow-y-auto">
        <!-- Notifications will be dynamically inserted here -->
      </div>
    </div>

    <!-- Budget Edit Modal -->
    <div id="budgetEditModal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
      <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6 border-b border-gray-200">
          <div class="flex items-center justify-between">
            <h3 class="text-2xl font-bold text-gray-800">Edit Budget Allocation</h3>
            <button onclick="closeBudgetEditModal()" class="text-gray-400 hover:text-gray-600 transition">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>
        </div>

        <div class="p-6">
          <!-- Instructions -->
          <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
            <div class="flex items-start">
              <svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <div>
                <p class="text-sm font-semibold text-blue-900 mb-1">Important Information</p>
                <p class="text-xs text-blue-800">This budget allocation will be displayed on the <strong>Dashboard homepage</strong> in the "Transparency & Budget Reports" section. You can add or remove budget categories, and the breakdown will be shown to all visitors for full transparency on how barangay funds are utilized throughout the year.</p>
              </div>
            </div>
          </div>

          <div class="space-y-4">
            <!-- Year Selection -->
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Budget Year</label>
              <input
                type="number"
                id="editBudgetYear"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"
                min="2020"
                max="2030"
              />
            </div>

            <!-- Budget Categories Container -->
            <div>
              <div class="flex items-center justify-between mb-3">
                <label class="block text-sm font-medium text-gray-700">Budget Categories</label>
                <button onclick="addBudgetCategory()" type="button" class="text-sm text-[#2f6e4e] hover:text-[#2f6e4e] font-medium flex items-center">
                  <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                  </svg>
                  Add Category
                </button>
              </div>

              <div id="budgetCategoriesContainer" class="space-y-3">
                <!-- Categories will be dynamically rendered here -->
              </div>
            </div>

            <!-- Total Budget Display -->
            <div class="pt-4 border-t border-gray-200 flex justify-between items-center">
              <span class="text-lg font-bold text-gray-800">Total Budget</span>
              <span class="text-2xl font-bold text-blue-600" id="editTotalBudget">₱0</span>
            </div>
          </div>
        </div>

        <div class="p-6 border-t border-gray-200 flex justify-end space-x-3">
          <button onclick="closeBudgetEditModal()" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition font-medium">
            Cancel
          </button>
          <button onclick="saveBudgetAllocation()" class="px-6 py-3 bg-[#2f6e4e] hover:bg-[#2f6e4e] text-white rounded-lg transition font-medium">
            Save Changes
          </button>
        </div>
      </div>
    </div>

    <script>
      let currentAnnouncementId = null;

      // Detect user role based on referrer or session
      const userRole = (document.referrer.includes('captain-dashboard.html') ||
                       sessionStorage.getItem('userRole') === 'captain') ? 'captain' : 'sk_official';

      if (userRole === 'captain') {
        sessionStorage.setItem('userRole', 'captain');
      }

      // Sample announcement data (converted to array for pagination)
      const announcementsArray = [
        {
          id: 1,
          title: "Youth Sports Festival 2025",
          description:
            "Join us for an exciting sports festival featuring basketball, volleyball, and more! Open to all youth aged 15-30.",
          date: "Nov 18, 2025",
          category: "urgent",
        },
        {
          id: 2,
          title: "Free Skills Training Workshop",
          description:
            "Learn digital marketing, graphic design, and basic programming. Limited slots available!",
          date: "Nov 25, 2025",
          category: "general",
        },
        {
          id: 3,
          title: "Scholarship Program Now Open",
          description:
            "Applications for the SK Scholarship Program are now being accepted. Deadline: December 15, 2025.",
          date: "Nov 15, 2025",
          category: "update",
        },
        {
          id: 4,
          title: "Community Clean-Up Drive",
          description:
            "Join us in keeping our barangay clean and green. Bring your own gloves and cleaning materials.",
          date: "Dec 1, 2025",
          category: "general",
        },
        {
          id: 5,
          title: "Health and Wellness Seminar",
          description:
            "Free health check-up and wellness seminar for all residents. First 100 participants get free vitamins!",
          date: "Dec 8, 2025",
          category: "urgent",
        },
        {
          id: 6,
          title: "Christmas Gift Giving Program",
          description:
            "SK Malanday will distribute Christmas gifts to less fortunate families. Venue: Barangay Hall.",
          date: "Dec 20, 2025",
          category: "update",
        },
        {
          id: 7,
          title: "New Year's Eve Countdown Event",
          description:
            "Ring in the new year with us! Fireworks display, games, and prizes await. Family-friendly event.",
          date: "Dec 31, 2025",
          category: "general",
        }
      ];

      // Create backwards-compatible announcements object for existing functions
      const announcements = {};
      announcementsArray.forEach(ann => {
        announcements[ann.id] = ann;
      });

      // Pagination variables
      let currentAnnouncementPage = 0;
      const announcementsPerPage = 3;

      // Add activity log entry
      function addActivityLog(action, itemName) {
        // In a real application, this would send to the backend
        console.log(`Activity Log: SK Official ${action} - "${itemName}"`);
      }

      // Render announcements with pagination
      function renderAnnouncements() {
        const grid = document.getElementById('announcementsGrid');
        grid.innerHTML = '';

        const startIndex = currentAnnouncementPage * announcementsPerPage;
        const endIndex = startIndex + announcementsPerPage;
        const announcementsToShow = announcementsArray.slice(startIndex, endIndex);

        announcementsToShow.forEach(announcement => {
          const categoryColors = {
            urgent: {
              badge: 'bg-red-100 text-red-700',
              gradient: 'from-orange-400 to-orange-500',
              icon: `<svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`
            },
            general: {
              badge: 'bg-blue-100 text-blue-700',
              gradient: 'from-blue-400 to-blue-500',
              icon: `<svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>`
            },
            update: {
              badge: 'bg-[#2f6e4e]/20 text-[#2f6e4e]',
              gradient: 'from-green-400 to-green-500',
              icon: `<svg class="w-16 h-16 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>`
            }
          };

          const colors = categoryColors[announcement.category] || categoryColors.general;

          const card = document.createElement('div');
          card.className = 'border border-gray-200 rounded-xl overflow-hidden hover:shadow-lg transition';
          card.innerHTML = `
            <div class="h-32 bg-gradient-to-br ${colors.gradient} flex items-center justify-center">
              ${colors.icon}
            </div>
            <div class="p-5">
              <div class="flex items-center justify-between mb-3">
                <span class="px-3 py-1 ${colors.badge} text-xs font-medium rounded-full">${announcement.category}</span>
                <span class="text-xs text-gray-500">${announcement.date}</span>
              </div>
              <h4 class="text-lg font-bold text-gray-800 mb-2">${announcement.title}</h4>
              <p class="text-sm text-gray-600 mb-3">${announcement.description}</p>
              <div class="flex justify-end">
                <div class="flex space-x-2">
                  <button onclick="viewAnnouncement(${announcement.id})" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition" title="View">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                    </svg>
                  </button>
                  <button onclick="openEditModal(${announcement.id})" class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition" title="Edit">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                  </button>
                  <button onclick="confirmDelete(${announcement.id})" class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition" title="Delete">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                  </button>
                </div>
              </div>
            </div>
          `;
          grid.appendChild(card);
        });

        updateAnnouncementPagination();
      }

      // Update announcement pagination controls
      function updateAnnouncementPagination() {
        const totalPages = Math.ceil(announcementsArray.length / announcementsPerPage);
        const dotsContainer = document.getElementById('announcementPaginationDots');
        const navContainer = document.getElementById('announcementPaginationNav');

        if (totalPages <= 1) {
          dotsContainer.classList.add('hidden');
          navContainer.classList.add('hidden');
          return;
        }

        dotsContainer.classList.remove('hidden');
        navContainer.classList.remove('hidden');

        // Create pagination dots
        dotsContainer.innerHTML = Array.from({ length: totalPages }, (_, i) => `
          <button
            onclick="goToAnnouncementPage(${i})"
            class="h-2 rounded-full transition-all duration-300 ${i === currentAnnouncementPage ? 'bg-[#2f6e4e] w-8' : 'bg-gray-300 hover:bg-gray-400 w-2'}"
            style="min-height: 8px;"
          ></button>
        `).join('');
      }

      // Navigate announcements
      function navigateAnnouncements(direction) {
        const totalPages = Math.ceil(announcementsArray.length / announcementsPerPage);
        currentAnnouncementPage += direction;

        // Wrap around
        if (currentAnnouncementPage < 0) currentAnnouncementPage = totalPages - 1;
        if (currentAnnouncementPage >= totalPages) currentAnnouncementPage = 0;

        renderAnnouncements();
      }

      // Go to specific announcement page
      function goToAnnouncementPage(pageIndex) {
        currentAnnouncementPage = pageIndex;
        renderAnnouncements();
      }

      // Create Announcement Modal
      function openCreateModal() {
        document.getElementById("createModal").classList.remove("hidden");
      }

      function closeCreateModal() {
        document.getElementById("createModal").classList.add("hidden");
        document.getElementById("createTitle").value = "";
        document.getElementById("createCategory").value = "";
        document.getElementById("createDescription").value = "";
        document.getElementById("createImage").value = "";
      }

      function postAnnouncement() {
        const titleInput = document.getElementById("createTitle");
        const categoryInput = document.getElementById("createCategory");
        const descriptionInput = document.getElementById("createDescription");
        const imageInput = document.getElementById("createImage");

        const title = titleInput.value.trim();
        const category = categoryInput.value;
        const description = descriptionInput.value.trim();
        const image = imageInput.files[0];

        let isValid = true;

        // Validate title
        if (!title) {
          setInputState(titleInput, false);
          showToast("Title is required", "error");
          isValid = false;
        } else if (title.length < 5) {
          setInputState(titleInput, false);
          showToast("Title must be at least 5 characters", "error");
          isValid = false;
        } else {
          setInputState(titleInput, true);
        }

        // Validate category
        if (!category) {
          setInputState(categoryInput, false);
          showToast("Please select a category", "error");
          isValid = false;
        } else {
          setInputState(categoryInput, true);
        }

        // Validate description
        if (!description) {
          setInputState(descriptionInput, false);
          showToast("Description is required", "error");
          isValid = false;
        } else if (description.length < 10) {
          setInputState(descriptionInput, false);
          showToast("Description must be at least 10 characters", "error");
          isValid = false;
        } else {
          setInputState(descriptionInput, true);
        }

        // Validate image
        if (image && image.size > 5 * 1024 * 1024) {
          setInputState(imageInput, false);
          showToast("Image size must be less than 5MB", "error");
          return;
        }

        if (!isValid) {
          return;
        }

        // Show loading state
        const button = event.target;
        const originalButtonText = button.innerHTML;
        button.disabled = true;
        button.innerHTML = '<div class="spinner mx-auto"></div>';

        // Simulate posting delay
        setTimeout(() => {
          // Log activity
          addActivityLog("created announcement", title);

          showToast("Announcement posted successfully!", "success");

          // Reset form
          titleInput.value = '';
          categoryInput.value = '';
          descriptionInput.value = '';
          imageInput.value = '';
          document.getElementById('createDescCharCount').textContent = '0/500 characters';

          // Reset visual states
          setInputState(titleInput, null);
          setInputState(categoryInput, null);
          setInputState(descriptionInput, null);

          // Re-enable button
          button.disabled = false;
          button.innerHTML = originalButtonText;

          closeCreateModal();
        }, 800);
      }

      // Edit Announcement Modal
      function openEditModal(id) {
        currentAnnouncementId = id;
        const announcement = announcements[id];

        const titleInput = document.getElementById("editTitle");
        const categoryInput = document.getElementById("editCategory");
        const descriptionInput = document.getElementById("editDescription");

        titleInput.value = announcement.title;
        categoryInput.value = announcement.category || "";
        descriptionInput.value = announcement.description;

        // Update character count
        updateCharCount('editDescription', 'editDescCharCount', 500);

        // Clear any previous validation states
        setInputState(titleInput, null);
        setInputState(categoryInput, null);
        setInputState(descriptionInput, null);

        document.getElementById("editModal").classList.remove("hidden");
      }

      function closeEditModal() {
        document.getElementById("editModal").classList.add("hidden");
        currentAnnouncementId = null;
      }

      function saveEdit() {
        const titleInput = document.getElementById("editTitle");
        const categoryInput = document.getElementById("editCategory");
        const descriptionInput = document.getElementById("editDescription");
        const imageInput = document.getElementById("editImage");

        const title = titleInput.value.trim();
        const category = categoryInput.value;
        const description = descriptionInput.value.trim();
        const image = imageInput.files[0];

        let isValid = true;

        // Validate title
        if (!title) {
          setInputState(titleInput, false);
          showToast("Title is required", "error");
          isValid = false;
        } else if (title.length < 5) {
          setInputState(titleInput, false);
          showToast("Title must be at least 5 characters", "error");
          isValid = false;
        } else {
          setInputState(titleInput, true);
        }

        // Validate category
        if (!category) {
          setInputState(categoryInput, false);
          showToast("Please select a category", "error");
          isValid = false;
        } else {
          setInputState(categoryInput, true);
        }

        // Validate description
        if (!description) {
          setInputState(descriptionInput, false);
          showToast("Description is required", "error");
          isValid = false;
        } else if (description.length < 10) {
          setInputState(descriptionInput, false);
          showToast("Description must be at least 10 characters", "error");
          isValid = false;
        } else {
          setInputState(descriptionInput, true);
        }

        // Validate image
        if (image && image.size > 5 * 1024 * 1024) {
          setInputState(imageInput, false);
          showToast("Image size must be less than 5MB", "error");
          return;
        }

        if (!isValid) {
          return;
        }

        // Show loading state
        const button = event.target;
        const originalButtonText = button.innerHTML;
        button.disabled = true;
        button.innerHTML = '<div class="spinner mx-auto"></div>';

        // Simulate update delay
        setTimeout(() => {
          // Log activity
          addActivityLog("edited announcement", title);

          showToast("Announcement updated successfully!", "success");

          // Re-enable button
          button.disabled = false;
          button.innerHTML = originalButtonText;

          closeEditModal();
        }, 800);
      }

      // View Announcement Modal
      function viewAnnouncement(id) {
        const announcement = announcements[id];

        document.getElementById("viewTitle").textContent = announcement.title;
        document.getElementById("viewDescription").textContent =
          announcement.description;
        document.getElementById("viewDate").textContent = announcement.date;

        // Update category badge with proper styling
        const categoryBadge = document.getElementById("viewCategory");
        categoryBadge.textContent = announcement.category;

        // Remove all category classes
        categoryBadge.className = "px-3 py-1 text-xs font-medium rounded-full";

        // Add category-specific classes
        if (announcement.category === "urgent") {
          categoryBadge.classList.add("bg-red-100", "text-red-700");
        } else if (announcement.category === "general") {
          categoryBadge.classList.add("bg-blue-100", "text-blue-700");
        } else if (announcement.category === "update") {
          categoryBadge.classList.add("bg-[#2f6e4e]/20", "text-[#2f6e4e]");
        }

        document.getElementById("viewModal").classList.remove("hidden");
      }

      function closeViewModal() {
        document.getElementById("viewModal").classList.add("hidden");
      }

      // Delete Announcement
      function confirmDelete(id) {
        currentAnnouncementId = id;
        document.getElementById("deleteModal").classList.remove("hidden");
      }

      function closeDeleteModal() {
        document.getElementById("deleteModal").classList.add("hidden");
        currentAnnouncementId = null;
      }

      function deleteAnnouncement() {
        const announcement = announcements[currentAnnouncementId];

        // Log activity
        addActivityLog("deleted announcement", announcement.title);

        showToast("Announcement deleted successfully!");
        closeDeleteModal();
      }

      // Toast notification
      // Toast Notification System
      function showToast(message, type = 'success') {
        const existingToast = document.querySelector('.toast');
        if (existingToast) {
          existingToast.remove();
        }

        const toast = document.createElement('div');
        toast.className = `toast ${type}`;

        let icon = '';
        if (type === 'success') {
          icon = '<svg class="w-6 h-6 text-green-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
        } else if (type === 'error') {
          icon = '<svg class="w-6 h-6 text-red-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
        } else if (type === 'warning') {
          icon = '<svg class="w-6 h-6 text-yellow-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>';
        } else {
          icon = '<svg class="w-6 h-6 text-blue-500 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
        }

        toast.innerHTML = `
          ${icon}
          <div class="flex-1">
            <p class="text-sm font-medium text-gray-800">${message}</p>
          </div>
          <button onclick="this.parentElement.remove()" class="text-gray-400 hover:text-gray-600 transition">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        `;

        document.body.appendChild(toast);
        setTimeout(() => toast.classList.add('show'), 10);
        setTimeout(() => {
          toast.classList.remove('show');
          setTimeout(() => toast.remove(), 300);
        }, 4000);
      }

      // Confirmation modal system
      function showConfirm(title, message, onConfirm, confirmButtonText = 'Confirm', confirmButtonColor = 'yellow') {
        const modal = document.getElementById('confirmModal');
        const titleEl = document.getElementById('confirmTitle');
        const messageEl = document.getElementById('confirmMessage');
        const confirmBtn = document.getElementById('confirmOk');
        const cancelBtn = document.getElementById('confirmCancel');

        titleEl.textContent = title;
        messageEl.textContent = message;
        confirmBtn.textContent = confirmButtonText;

        // Update button colors
        if (confirmButtonColor === 'green') {
          confirmBtn.className = 'flex-1 px-4 py-2.5 bg-green-600 hover:bg-green-700 text-white rounded-lg transition font-medium';
        } else if (confirmButtonColor === 'red') {
          confirmBtn.className = 'flex-1 px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg transition font-medium';
        } else {
          confirmBtn.className = 'flex-1 px-4 py-2.5 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition font-medium';
        }

        modal.classList.remove('hidden');

        const handleConfirm = () => {
          modal.classList.add('hidden');
          onConfirm();
          cleanup();
        };

        const handleCancel = () => {
          modal.classList.add('hidden');
          cleanup();
        };

        const cleanup = () => {
          confirmBtn.removeEventListener('click', handleConfirm);
          cancelBtn.removeEventListener('click', handleCancel);
        };

        confirmBtn.addEventListener('click', handleConfirm);
        cancelBtn.addEventListener('click', handleCancel);

        // Close on click outside
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            handleCancel();
          }
        });
      }

      // Character counter for textareas
      function updateCharCount(inputId, counterId, maxLength) {
        const input = document.getElementById(inputId);
        const counter = document.getElementById(counterId);
        const currentLength = input.value.length;

        counter.textContent = `${currentLength}/${maxLength} characters`;

        counter.classList.remove('warning', 'error');
        if (currentLength >= maxLength) {
          counter.classList.add('error');
        } else if (currentLength >= maxLength * 0.9) {
          counter.classList.add('warning');
        }
      }

      // Input validation helper
      function setInputState(inputElement, isValid) {
        inputElement.classList.remove('input-error', 'input-success');
        if (isValid === true) {
          inputElement.classList.add('input-success');
        } else if (isValid === false) {
          inputElement.classList.add('input-error');
        }
      }

      // Notification System
      let notifications = [
        {
          id: 1,
          type: "project_approved",
          title: "Project Approved: Community Clean-Up Drive 2025",
          message: "Your project has been approved by the Barangay Captain and is now Ongoing",
          time: "2 hours ago",
          read: false,
          projectId: 1,
          status: "approved",
        },
        {
          id: 2,
          type: "project_rejected",
          title: "Project Rejected: International Youth Exchange Program",
          message: "Your project has been rejected. Click to view captain's feedback and edit your proposal",
          time: "1 day ago",
          read: false,
          projectId: 4,
          status: "rejected",
        },
        {
          id: 3,
          type: "project_revision",
          title: "Revision Requested: Scholarship Program Deadline",
          message: "The Barangay Captain requested revisions. Click to view feedback and edit your project",
          time: "3 hours ago",
          read: false,
          projectId: 3,
          status: "revision",
        },
        {
          id: 4,
          type: "new_inquiry",
          title: "New Inquiry: Community Clean-Up Drive 2025",
          message: "Juan Dela Cruz posted a new inquiry on your project",
          time: "5 minutes ago",
          read: false,
          projectId: 1,
        },
        {
          id: 5,
          type: "inquiry_reply",
          title: "Inquiry Reply: Youth Sports Festival",
          message: "Maria Santos replied to an inquiry thread",
          time: "1 hour ago",
          read: false,
          projectId: 2,
        },
        {
          id: 6,
          type: "new_announcement",
          title: "New Announcement Posted",
          message: "Kyleen Nicdao posted a new announcement",
          time: "2 hours ago",
          read: false,
          referenceId: 1,
        },
        {
          id: 7,
          type: "new_project",
          title: "New Project: Beach Clean-Up Initiative",
          message: "Andrea Pelias created a new project",
          time: "3 hours ago",
          read: false,
          referenceId: 3,
        },
        {
          id: 8,
          type: "project_application",
          title: "New Application: Community Clean-Up Drive 2025",
          message: "Juan Dela Cruz applied to your project",
          time: "30 minutes ago",
          read: false,
          projectId: 1,
          applicantId: 1,
        },
      ];

      function toggleNotificationModal() {
        const modal = document.getElementById("notificationModal");
        modal.classList.toggle("hidden");
        if (!modal.classList.contains("hidden")) {
          renderNotifications();
        }
      }

      function closeNotificationModal() {
        document.getElementById("notificationModal").classList.add("hidden");
      }

      function updateNotificationCount() {
        // Filter notifications based on user role
        let filteredNotifications = notifications;
        if (userRole === 'captain') {
          filteredNotifications = notifications.filter(n =>
            n.type === 'pending_approval' || n.type === 'new_announcement'
          );
        }

        const unreadCount = filteredNotifications.filter((n) => !n.read).length;
        const badge = document.getElementById("notificationBadge");

        if (unreadCount > 0) {
          badge.textContent = unreadCount > 9 ? "9+" : unreadCount;
          badge.classList.remove("hidden");
        } else {
          badge.classList.add("hidden");
        }
      }

      function getNotificationIcon(type) {
        // Map different type strings used across pages to unified icon categories
        function mapToCategory(t) {
          if (!t) return "default";
          if (t === "new_announcement" || t === "announcement")
            return "announcement";
          if (
            t === "new_inquiry" ||
            t === "inquiry_reply" ||
            t === "inquiry_update"
          )
            return "inquiry";
          if (t === "new_project" || t === "project_posted" || t === "project")
            return "project";
          if (
            t === "project_application" ||
            t === "application_approved" ||
            t === "application_pending"
          )
            return "application";
          if (t === "pending_approval")
            return "pending_approval";
          if (t === "project_approved")
            return "project_approved";
          if (t === "project_rejected")
            return "project_rejected";
          if (t === "project_revision-requested")
            return "project_revision";
          return "default";
        }

        const cat = mapToCategory(type);

        switch (cat) {
          case "inquiry":
            return `<div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>\n              </svg>\n            </div>`;
          case "announcement":
            return `<div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6"></path>\n              </svg>\n            </div>`;
          case "project":
            return `<div class="w-10 h-10 bg-[#2f6e4e]/20 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-[#2f6e4e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"></path>\n              </svg>\n            </div>`;
          case "application":
            return `<div class="w-10 h-10 bg-[#2f6e4e]/20 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-[#2f6e4e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n              </svg>\n            </div>`;
          case "pending_approval":
            return `<div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n              </svg>\n            </div>`;
          case "project_approved":
            return `<div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n              </svg>\n            </div>`;
          case "project_rejected":
            return `<div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n              </svg>\n            </div>`;
          case "project_revision":
            return `<div class="w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>\n              </svg>\n            </div>`;
          default:
            return `<div class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center flex-shrink-0">\n              <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659"></path>\n              </svg>\n            </div>`;
        }
      }

      function getNotificationBgColor(type) {
        switch (type) {
          case "new_inquiry":
            return "bg-yellow-50";
          case "inquiry_reply":
            return "bg-yellow-50";
          case "new_announcement":
            return "bg-blue-50";
          case "new_project":
            return "bg-[#2f6e4e]/10";
          case "project_application":
            return "bg-[#2f6e4e]/10";
          case "pending_approval":
            return "bg-orange-50";
          default:
            return "bg-gray-50";
        }
      }

      function renderNotifications() {
        const notificationList = document.getElementById("notificationList");

        // Filter notifications based on user role
        let filteredNotifications = notifications;
        if (userRole === 'captain') {
          // Captain only sees: pending project submissions and new announcements
          filteredNotifications = notifications.filter(n =>
            n.type === 'pending_approval' || n.type === 'new_announcement'
          );
        }

        if (filteredNotifications.length === 0) {
          notificationList.innerHTML = `
            <div class="p-8 text-center text-gray-500">
              <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
              </svg>
              <p class="font-medium">No notifications</p>
              <p class="text-sm mt-1">You're all caught up!</p>
            </div>
          `;
          return;
        }

        notificationList.innerHTML = filteredNotifications
          .map(
            (notif) => `
          <div
            onclick="handleNotificationClick(${notif.id})"
            class="p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition ${
              !notif.read ? getNotificationBgColor(notif.type) : ""
            }"
          >
            <div class="flex items-start space-x-3">
              ${getNotificationIcon(notif.type)}
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between">
                  <p class="text-sm font-semibold text-gray-800 truncate ${
                    !notif.read ? "font-bold" : ""
                  }">
                    ${notif.title}
                  </p>
                  ${
                    !notif.read
                      ? '<span class="w-2 h-2 bg-[#2f6e4e] rounded-full flex-shrink-0 ml-2 mt-1"></span>'
                      : ""
                  }
                </div>
                <p class="text-xs text-gray-600 mt-1">${notif.message}</p>
                <p class="text-xs text-gray-400 mt-2">${notif.time}</p>
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      function handleNotificationClick(notifId) {
        const notif = notifications.find((n) => n.id === notifId);
        if (!notif) return;

        notif.read = true;
        updateNotificationCount();
        closeNotificationModal();

        // Route to appropriate page based on notification type
        if (notif.type === "new_inquiry" || notif.type === "inquiry_reply") {
          window.location.href = `sk-projects.html?projectId=${notif.projectId}&tab=inquiries`;
        } else if (notif.type === "new_announcement") {
          // View the announcement on dashboard
          viewAnnouncement(notif.referenceId);
        } else if (notif.type === "new_project") {
          window.location.href = `sk-projects.html?projectId=${notif.referenceId}`;
        } else if (notif.type === "project_application") {
          window.location.href = `sk-projects.html?projectId=${notif.projectId}&tab=applications&applicantId=${notif.applicantId}`;
        } else if (notif.type === "project_approved" || notif.type === "project_rejected" || notif.type === "project_revision-requested") {
          // Show modal with captain's decision and comments
          showDecisionModal(notif);
        }
      }

      // Show modal for project decision notifications
      function showDecisionModal(notif) {
        const decision = notif.decision;
        const comments = notif.comments || 'No comments provided.';

        let icon = '';
        let iconBg = '';
        let title = '';

        if (decision === 'approved') {
          icon = '✓';
          iconBg = 'bg-green-100 text-green-600';
          title = 'Project Approved';
        } else if (decision === 'rejected') {
          icon = '✗';
          iconBg = 'bg-red-100 text-red-600';
          title = 'Project Rejected';
        } else if (decision === 'revision-requested') {
          icon = '✎';
          iconBg = 'bg-yellow-100 text-yellow-600';
          title = 'Revision Requested';
        }

        const modalHTML = `
          <div id="decisionModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4" onclick="closeDecisionModal()">
            <div class="bg-white rounded-xl shadow-2xl max-w-lg w-full" onclick="event.stopPropagation()">
              <div class="p-6">
                <div class="flex items-center justify-center mb-4">
                  <div class="w-16 h-16 ${iconBg} rounded-full flex items-center justify-center text-3xl font-bold">
                    ${icon}
                  </div>
                </div>
                <h2 class="text-2xl font-bold text-gray-800 text-center mb-2">${title}</h2>
                <p class="text-center text-gray-600 mb-4">${notif.projectName}</p>

                <div class="bg-gray-50 rounded-lg p-4 mb-6">
                  <h3 class="text-sm font-semibold text-gray-700 mb-2">Barangay Captain's Comments:</h3>
                  <p class="text-gray-700 whitespace-pre-wrap">${comments}</p>
                </div>

                <div class="flex gap-3">
                  <button onclick="closeDecisionModal()" class="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition font-medium">
                    Close
                  </button>
                  <button onclick="closeDecisionModal(); window.location.href='sk-projects.html'" class="flex-1 px-4 py-2 bg-[#2f6e4e] text-white rounded-lg hover:bg-[#2f6e4e] transition font-medium">
                    View Projects
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;

        // Remove existing modal if any
        const existingModal = document.getElementById('decisionModal');
        if (existingModal) existingModal.remove();

        // Add modal to body
        document.body.insertAdjacentHTML('beforeend', modalHTML);
      }

      function closeDecisionModal() {
        const modal = document.getElementById('decisionModal');
        if (modal) modal.remove();
      }

      function markAllAsRead() {
        notifications.forEach((n) => (n.read = true));
        updateNotificationCount();
        renderNotifications();
      }

      // Close notification modal when clicking outside
      document.addEventListener("click", function (event) {
        const modal = document.getElementById("notificationModal");
        const notificationButton = event.target.closest(
          'button[onclick="toggleNotificationModal()"]'
        );

        if (
          !modal.contains(event.target) &&
          !notificationButton &&
          !modal.classList.contains("hidden")
        ) {
          closeNotificationModal();
        }
      });

      // Load SK notifications from localStorage
      function loadSKNotifications() {
        const skNotifications = JSON.parse(localStorage.getItem('skNotifications') || '[]');

        // Add SK notifications to the notifications array
        skNotifications.forEach(skNotif => {
          // Check if notification already exists
          const exists = notifications.find(n => n.id === skNotif.id);
          if (!exists) {
            notifications.unshift(skNotif);
          }
        });
      }

      // Initialize demo notifications (run once)
      function initializeDemoNotifications() {
        // Check if demo already initialized
        if (localStorage.getItem('demoNotificationsInitialized')) {
          return;
        }

        // Create demo notifications
        const demoNotifications = [
          {
            id: Date.now() - 3000,
            projectId: 1,
            projectName: "New Year Community Festival 2026",
            type: "project_approved",
            decision: "approved",
            comments: "Great initiative! The project proposal is well-structured and the budget is reasonable. Approved for implementation. Please ensure all safety protocols are followed during the event.",
            timestamp: new Date(Date.now() - 7200000).toISOString(), // 2 hours ago
            timeAgo: "2 hours ago",
            read: false,
            title: "Project Approved: New Year Community Festival 2026",
            message: "Your project has been approved by the Barangay Captain"
          },
          {
            id: Date.now() - 2000,
            projectId: 2,
            projectName: "Youth Skills Training Program",
            type: "project_revision-requested",
            decision: "revision-requested",
            comments: "The project concept is good, but please revise the following:\n\n1. Reduce the budget from ₱42,000 to ₱35,000\n2. Add more details on the training modules and instructors\n3. Include a monitoring and evaluation plan\n4. Provide certificates sample design\n\nPlease resubmit within 5 working days.",
            timestamp: new Date(Date.now() - 1800000).toISOString(), // 30 minutes ago
            timeAgo: "30 minutes ago",
            read: false,
            title: "Revision Requested: Youth Skills Training Program",
            message: "The Barangay Captain has requested revisions to your project"
          },
          {
            id: Date.now() - 1000,
            projectId: 8,
            projectName: "International Youth Exchange Program",
            type: "project_rejected",
            decision: "rejected",
            comments: "After careful review, this project cannot be approved due to:\n\n1. Budget of ₱250,000 exceeds our Q1 allocation\n2. Not aligned with current barangay priorities\n3. Limited direct benefit to the community\n\nWe suggest focusing on local programs that can benefit more residents. You may consider a local cultural exchange with nearby barangays instead.",
            timestamp: new Date(Date.now() - 3600000).toISOString(), // 1 hour ago
            timeAgo: "1 hour ago",
            read: false,
            title: "Project Rejected: International Youth Exchange Program",
            message: "Your project has been rejected by the Barangay Captain"
          }
        ];

        // Save to localStorage
        localStorage.setItem('skNotifications', JSON.stringify(demoNotifications));
        localStorage.setItem('demoNotificationsInitialized', 'true');

        console.log('Demo notifications initialized');
      }

      // Reset demo notifications function
      function resetDemoNotifications() {
        showConfirm(
          'Reset Notifications',
          'This will reset all demo notifications. Continue?',
          () => {
            localStorage.removeItem('demoNotificationsInitialized');
            localStorage.removeItem('skNotifications');

            // Clear current notifications
            notifications = notifications.filter(n =>
              !n.type.startsWith('project_approved') &&
              !n.type.startsWith('project_rejected') &&
              !n.type.startsWith('project_revision')
            );

            // Reinitialize demo
            initializeDemoNotifications();
            loadSKNotifications();
            updateNotificationCount();
            renderNotifications();

            showToast('Demo notifications reset! You should now see 3 new notifications.', 'success');
          },
          'Reset',
          'yellow'
        );
      }

      // Initialize demo notifications
      initializeDemoNotifications();

      // Initialize notification count on page load
      loadSKNotifications();
      updateNotificationCount();

      // Update current date
      function updateCurrentDate() {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const currentDate = new Date().toLocaleDateString('en-US', options);
        const dateElement = document.getElementById('currentDate');
        if (dateElement) {
          dateElement.textContent = currentDate;
        }
      }
      updateCurrentDate();

      // ===========================
      // BUDGET & METRICS MANAGEMENT
      // ===========================

      // Budget data structure (now with dynamic categories)
      let budgetData = {
        year: 2025,
        categories: [
          { id: 1, name: 'Youth Development Programs', amount: 450000 },
          { id: 2, name: 'Community Events', amount: 300000 },
          { id: 3, name: 'Infrastructure Projects', amount: 250000 }
        ],
        history: []
      };

      // Project metrics data
      let projectMetrics = {
        year: 2025,
        total: 42,
        completed: 38,
        ongoing: 4,
        successRate: 89
      };

      // Load budget data from localStorage
      function loadBudgetData() {
        const saved = localStorage.getItem('budgetData');
        if (saved) {
          budgetData = JSON.parse(saved);
          updateBudgetDisplay();
        }
      }

      // Load project metrics from localStorage
      function loadProjectMetrics() {
        const saved = localStorage.getItem('projectMetrics');
        if (saved) {
          projectMetrics = JSON.parse(saved);
          updateMetricsDisplay();
        }
      }

      // Update budget display
      function updateBudgetDisplay() {
        const budgetContainer = document.querySelector('.bg-gradient-to-br.from-blue-50 .space-y-4');
        if (!budgetContainer) return;

        const total = budgetData.categories.reduce((sum, cat) => sum + cat.amount, 0);

        document.getElementById('budgetYearTitle').textContent = `${budgetData.year} Budget Allocation`;
        document.getElementById('totalBudget').textContent = `₱${total.toLocaleString()}`;

        // Clear existing category displays
        const categoriesHTML = budgetData.categories.map(category => {
          const percent = total > 0 ? (category.amount / total * 100).toFixed(0) : 0;
          return `
            <div>
              <div class="flex justify-between text-sm mb-1">
                <span class="text-gray-700 font-medium">${category.name}</span>
                <span class="text-gray-900 font-semibold">₱${category.amount.toLocaleString()}</span>
              </div>
              <div class="w-full bg-blue-100 rounded-full h-2">
                <div class="bg-blue-600 h-2 rounded-full" style="width: ${percent}%"></div>
              </div>
            </div>
          `;
        }).join('');

        // Find the container and update it (preserve the total budget section)
        const totalSection = budgetContainer.querySelector('.pt-4.border-t');
        budgetContainer.innerHTML = categoriesHTML;
        if (totalSection) {
          budgetContainer.appendChild(totalSection);
        }
      }

      // Update metrics display
      function updateMetricsDisplay() {
        document.getElementById('totalProjects').textContent = projectMetrics.total;
        document.getElementById('completedProjects').textContent = projectMetrics.completed;
        document.getElementById('ongoingProjects').textContent = projectMetrics.ongoing;
        document.getElementById('successRate').textContent = `${projectMetrics.successRate}%`;
        document.getElementById('projectsYear').textContent = projectMetrics.year;
      }

      // Render budget categories in edit modal
      function renderBudgetCategoriesEdit() {
        const container = document.getElementById('budgetCategoriesContainer');
        container.innerHTML = '';

        budgetData.categories.forEach((category, index) => {
          const categoryDiv = document.createElement('div');
          categoryDiv.className = 'flex gap-2';
          categoryDiv.innerHTML = `
            <div class="flex-1">
              <input
                type="text"
                value="${category.name}"
                onchange="updateCategoryName(${category.id}, this.value)"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent text-sm"
                placeholder="Category name"
              />
            </div>
            <div class="flex-1">
              <div class="relative">
                <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm">₱</span>
                <input
                  type="number"
                  value="${category.amount}"
                  onchange="updateCategoryAmount(${category.id}, this.value)"
                  oninput="updateEditBudgetTotal()"
                  class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent text-sm"
                  min="0"
                  step="1000"
                  placeholder="Amount"
                />
              </div>
            </div>
            <button
              onclick="removeBudgetCategory(${category.id})"
              class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition"
              title="Remove category"
              ${budgetData.categories.length <= 1 ? 'disabled style="opacity: 0.5; cursor: not-allowed;"' : ''}
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
              </svg>
            </button>
          `;
          container.appendChild(categoryDiv);
        });

        updateEditBudgetTotal();
      }

      // Add new budget category
      function addBudgetCategory() {
        const newId = Math.max(...budgetData.categories.map(c => c.id), 0) + 1;
        budgetData.categories.push({
          id: newId,
          name: '',
          amount: 0
        });
        renderBudgetCategoriesEdit();
      }

      // Remove budget category
      function removeBudgetCategory(id) {
        if (budgetData.categories.length <= 1) {
          showToast('You must have at least one budget category.', 'warning');
          return;
        }
        budgetData.categories = budgetData.categories.filter(c => c.id !== id);
        renderBudgetCategoriesEdit();
      }

      // Update category name
      function updateCategoryName(id, name) {
        const category = budgetData.categories.find(c => c.id === id);
        if (category) {
          category.name = name;
        }
      }

      // Update category amount
      function updateCategoryAmount(id, amount) {
        const category = budgetData.categories.find(c => c.id === id);
        if (category) {
          category.amount = parseInt(amount) || 0;
        }
        updateEditBudgetTotal();
      }

      // Edit budget allocation
      function editBudgetAllocation() {
        const modal = document.getElementById('budgetEditModal');
        document.getElementById('editBudgetYear').value = budgetData.year;
        renderBudgetCategoriesEdit();
        modal.classList.remove('hidden');
      }

      function closeBudgetEditModal() {
        document.getElementById('budgetEditModal').classList.add('hidden');
      }

      function updateEditBudgetTotal() {
        const total = budgetData.categories.reduce((sum, cat) => sum + cat.amount, 0);
        document.getElementById('editTotalBudget').textContent = `₱${total.toLocaleString()}`;
      }

      function saveBudgetAllocation() {
        // Validate that all categories have names
        const emptyNames = budgetData.categories.filter(c => !c.name.trim());
        if (emptyNames.length > 0) {
          showToast('Please provide names for all budget categories.', 'error');
          return;
        }

        budgetData.year = parseInt(document.getElementById('editBudgetYear').value);

        localStorage.setItem('budgetData', JSON.stringify(budgetData));
        updateBudgetDisplay();
        closeBudgetEditModal();

        // Show success message
        showToast('Budget allocation updated successfully!', 'success');
      }

      function viewBudgetHistory() {
        showToast('Budget history feature coming soon!', 'info');
      }

      // Initialize on page load
      loadBudgetData();
      loadProjectMetrics();
      renderAnnouncements();
    </script>
    <script src="js/mobile-nav.js"></script>
  </body>
</html>
