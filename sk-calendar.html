<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>BIMS - SK Manage Calendar</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="css/responsive.css" />

    <!-- FullCalendar -->
    <link
      href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

    <style>
      .fc .fc-toolbar-title {
        font-weight: 700;
      }
      .fc-event {
        cursor: pointer;
      }
      .modal-open {
        overflow: hidden;
      }
      .icon-wrapper { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
      .icon-wrapper:hover { transform: translateY(-2px); }
      .nav-link svg { transition: all 0.3s ease; }
      .nav-link:hover svg { transform: scale(1.1); }
      .icon-badge { box-shadow: 0 2px 8px rgba(47, 110, 78, 0.15); }
      .notification-icon { position: relative; }
      .notification-icon:hover { transform: rotate(15deg) scale(1.1); transition: transform 0.3s ease; }
      .status-icon-pending { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
      .status-icon-approved { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
      .status-icon-rejected { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
      .icon-primary { filter: drop-shadow(0 2px 4px rgba(47, 110, 78, 0.1)); }
      .icon-glow { filter: drop-shadow(0 0 8px rgba(47, 110, 78, 0.3)); }
    </style>
  </head>
  <body class="bg-gray-50">
    <div class="flex h-screen overflow-hidden">
      <!-- SIDEBAR -->
      <aside
        class="w-64 bg-white shadow-lg flex-shrink-0 h-screen flex flex-col"
      >
        <div class="p-6 flex-1 flex flex-col">
          <!-- Logo -->
          <div class="flex items-center space-x-4 mb-8">
            <div
              class="w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-lg icon-badge overflow-hidden"
            >
              <img src="asset/logo.svg" alt="BIMS Logo" class="w-full h-full object-contain p-1">
            </div>
            <div>
              <h1 class="text-xl font-black text-gray-800">BIMS</h1>
              <p class="text-sm text-gray-600 font-medium">SK Malanday</p>
            </div>
          </div>

          <nav class="space-y-2">
            <a
              href="sk-dashboard.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-green-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-green-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3"
                  ></path>
                </svg>
              </div>
              <span>Dashboard</span>
            </a>
            <a
              href="sk-files.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-blue-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-blue-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  ></path>
                </svg>
              </div>
              <span>Manage Files</span>
            </a>
            <a
              href="sk-projects.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-purple-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-purple-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"
                  ></path>
                </svg>
              </div>
              <span>Project Monitoring</span>
            </a>
            <a
              href="sk-calendar.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 bg-[#2f6e4e]/10 text-[#2f6e4e] rounded-lg font-medium group"
            >
              <div class="w-9 h-9 bg-[#2f6e4e]/20 rounded-lg flex items-center justify-center group-hover:bg-[#2f6e4e]/30 transition">
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2.5"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                  ></path>
                </svg>
              </div>
              <span>Calendar</span>
            </a>
            <a
              href="sk-testimonies.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-indigo-50 transition">
                <svg
                  class="w-5 h-5 group-hover:text-indigo-600 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
                  ></path>
                </svg>
              </div>
              <span>Testimonies</span>
            </a>
            <a
              href="sk-archive.html"
              class="nav-link flex items-center space-x-3 px-4 py-3 text-gray-600 hover:bg-gray-50 rounded-lg transition group"
            >
              <div class="w-9 h-9 bg-gray-100 rounded-lg flex items-center justify-center group-hover:bg-gray-200 transition">
                <svg
                  class="w-5 h-5 group-hover:text-gray-700 transition"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"
                  ></path>
                </svg>
              </div>
              <span>Archives</span>
            </a>
          </nav>

          <div class="flex-1"></div>

          <div class="mt-8 pt-8 border-t border-gray-200">
            <button
              class="nav-link flex items-center space-x-3 px-4 py-3 text-red-600 hover:bg-red-50 rounded-lg transition w-full group"
            >
              <div class="w-9 h-9 bg-red-50 rounded-lg flex items-center justify-center group-hover:bg-red-100 transition">
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"
                  ></path>
                </svg>
              </div>
              <span class="font-medium">Logout</span>
            </button>
          </div>
        </div>
      </aside>

      <!-- MAIN -->
      <div class="flex-1 overflow-auto">
        <!-- Top bar -->
        <header class="bg-gradient-to-r from-[#2f6e4e]/10 to-white border-b border-gray-200 sticky top-0 z-20">
          <div class="px-8 py-6">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-[#2f6e4e] font-semibold mb-1" id="currentDate">Sunday, December 14, 2025</p>
                <h1 class="text-2xl font-bold text-gray-800">Manage Calendar</h1>
                <p class="text-sm text-gray-600 mt-1">Manage project deadlines and schedules</p>
              </div>
              <div class="flex items-center space-x-4">
                <div class="relative">
                  <button onclick="toggleNotificationModal()" class="p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition" title="Notifications">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                    </svg>
                    <span id="notificationBadge" class="hidden absolute -top-1 -right-1 bg-red-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center">5</span>
                  </button>
                </div>
                <button onclick="openProfileModal()" class="flex items-center space-x-3 hover:bg-gray-100 rounded-lg px-3 py-2 transition-colors">
                  <div class="text-right">
                    <p class="text-sm font-medium text-gray-700 group-hover:text-[#2f6e4e] transition">Andrea Pelias</p>
                    <p class="text-xs text-gray-500">SK Chairman</p>
                  </div>
                  <div class="w-10 h-10 bg-gradient-to-br from-[#2f6e4e] to-[#3d8b64] rounded-full flex items-center justify-center text-white font-semibold shadow-lg ring-2 ring-[#2f6e4e]/20 group-hover:ring-[#2f6e4e]/40 transition">
                    AP
                  </div>
                </button>
              </div>
            </div>
          </div>
        </header>

        <div class="max-w-7xl mx-auto px-6 py-6">
          <!-- Calendar + side -->
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Calendar main -->
            <div class="lg:col-span-2 bg-white rounded-xl p-4 shadow-sm">
              <div id="calendar"></div>
            </div>

            <!-- Sidebar quick list -->
            <div class="bg-white rounded-xl p-4 shadow-sm">
              <h4 class="font-bold text-gray-800 mb-3">
                Upcoming (next 30 days)
              </h4>
              <ul
                id="upcomingList"
                class="space-y-3 text-sm text-gray-700"
              ></ul>

              <hr class="my-4" />

              <h4 class="font-bold text-gray-800 mb-3">Quick Actions</h4>
              <div class="flex flex-col gap-2">
                <button
                  id="showAllProjects"
                  class="px-3 py-2 border border-gray-200 rounded-lg hover:bg-gray-50"
                >
                  Show all projects
                </button>
                <button
                  id="notifyVols"
                  class="px-3 py-2 bg-[#2f6e4e] text-white rounded-lg hover:bg-[#2f6e4e]"
                >
                  Notify volunteers (demo)
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- View Event Modal -->
    <div
      id="viewModal"
      class="hidden fixed inset-0 z-50 flex items-start justify-center bg-black bg-opacity-40 p-6"
    >
      <div
        class="bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto"
      >
        <div class="p-6 border-b flex items-start justify-between gap-4">
          <div class="flex-1">
            <h3 id="viewTitle" class="text-2xl font-bold text-gray-800">
              Event Title
            </h3>
            <p id="viewRange" class="text-sm text-gray-500 mt-1">
              Date range / time
            </p>
          </div>
          <div class="flex items-center gap-3">
            <span
              id="viewTypeBadge"
              class="px-3 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-700 hidden"
              >Type</span
            >
            <button
              onclick="closeViewModal()"
              class="text-gray-400 hover:text-gray-600"
            >
              ✕
            </button>
          </div>
        </div>

        <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="md:col-span-2 space-y-3">
            <div
              id="viewBannerWrap"
              class="w-full rounded-lg overflow-hidden h-44 bg-gray-100 flex items-center justify-center"
            ></div>
            <p id="viewDesc" class="text-gray-700"></p>

            <div class="flex items-center gap-4 text-sm text-gray-600">
              <div><strong>Head:</strong> <span id="viewHead"></span></div>
              <div>
                <strong>Status:</strong>
                <span id="viewStatus" class="font-medium"></span>
              </div>
              <div>
                <strong>Inquiries:</strong>
                <span id="viewInquiries" class="font-medium"></span>
              </div>
            </div>

            <div class="mt-4 flex gap-2">
              <button
                id="openInquiryBtn"
                class="px-3 py-2 border border-gray-200 rounded-lg"
              >
                View / Reply Inquiries
              </button>
              <button
                id="viewProjectDetailsBtn"
                class="px-3 py-2 bg-[#2f6e4e] text-white rounded-lg"
              >
                View Project Details
              </button>
            </div>
          </div>

          <div class="space-y-3">
            <div class="bg-gray-50 p-3 rounded-lg">
              <p class="text-xs text-gray-500">Start</p>
              <p id="viewStart" class="font-medium text-gray-800"></p>
            </div>
            <div class="bg-gray-50 p-3 rounded-lg">
              <p class="text-xs text-gray-500">End</p>
              <p id="viewEnd" class="font-medium text-gray-800"></p>
            </div>
            <div class="bg-gray-50 p-3 rounded-lg">
              <p class="text-xs text-gray-500">Location</p>
              <p id="viewLocation" class="font-medium text-gray-800">—</p>
            </div>
          </div>
        </div>

        <div class="p-6 flex justify-end border-t">
          <button
            onclick="closeViewModal()"
            class="px-4 py-2 border border-gray-200 rounded-lg"
          >
            Close
          </button>
        </div>
      </div>
    </div>

    <!-- Inquiry Side Modal -->
    <div id="inquiryModal" class="hidden fixed inset-0 z-60 flex">
      <div
        class="fixed inset-0 bg-black bg-opacity-40"
        onclick="closeInquiryModal()"
      ></div>
      <aside
        class="ml-auto w-full sm:w-[480px] bg-white h-full shadow-2xl overflow-auto"
      >
        <div class="p-6 border-b flex items-center justify-between">
          <div>
            <h4 class="text-lg font-bold">Inquiries</h4>
            <p id="inquiryEventTitle" class="text-xs text-gray-500">Event</p>
          </div>
          <button
            onclick="closeInquiryModal()"
            class="text-gray-400 hover:text-gray-600"
          >
            ✕
          </button>
        </div>

        <div class="p-6 space-y-4">
          <div
            id="inquiryList"
            class="space-y-3 max-h-[60vh] overflow-y-auto"
          ></div>

          <div>
            <label class="block text-sm text-gray-700 mb-2">Reply</label>
            <textarea
              id="replyText"
              rows="4"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg"
            ></textarea>
            <div class="flex justify-end mt-3">
              <button
                onclick="sendReply()"
                class="px-4 py-2 bg-[#2f6e4e] text-white rounded-lg"
              >
                Send Reply
              </button>
            </div>
          </div>
        </div>
      </aside>
    </div>

    <!-- Notify Volunteers Modal -->
    <div
      id="notifyModal"
      class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto"
      >
        <div class="p-6 border-b flex items-center justify-between">
          <h3 class="text-2xl font-bold">Notify Volunteers</h3>
          <button
            onclick="closeNotifyModal()"
            class="text-gray-400 hover:text-gray-600"
          >
            ✕
          </button>
        </div>

        <div class="p-6 space-y-6">
          <!-- Select Project/Event -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Select Project/Event</label
            >
            <select
              id="notifyProject"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg"
            >
              <option value="">All Projects</option>
            </select>
            <p class="text-xs text-gray-500 mt-1">
              Choose a specific project or notify about all upcoming events
            </p>
          </div>

          <!-- Target Group -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Target Group</label
            >
            <select
              id="notifyTarget"
              onchange="updateVolunteerCount()"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg"
            >
              <option value="all">All Volunteers</option>
              <option value="approved">Approved Applicants Only</option>
              <option value="pending">Pending Applicants</option>
              <option value="project-specific">
                Project-Specific Volunteers
              </option>
            </select>
            <p class="text-xs text-gray-500 mt-1">
              <span id="volunteerCount" class="font-semibold text-[#2f6e4e]"
                >0 volunteers</span
              >
              will receive this notification
            </p>
          </div>

          <!-- Message -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Message</label
            >
            <textarea
              id="notifyMessage"
              rows="6"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg resize-none"
              placeholder="Write your message to volunteers..."
            ></textarea>
            <p class="text-xs text-gray-500 mt-1">
              <span id="charCount">0</span>/500 characters
            </p>
          </div>

          <!-- Quick Message Templates -->
          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2"
              >Quick Templates</label
            >
            <div class="flex flex-wrap gap-2">
              <button
                onclick="useTemplate('reminder')"
                class="px-3 py-1.5 text-xs border border-gray-300 rounded-lg hover:bg-gray-50"
              >
                Event Reminder
              </button>
              <button
                onclick="useTemplate('cancelled')"
                class="px-3 py-1.5 text-xs border border-gray-300 rounded-lg hover:bg-gray-50"
              >
                Event Cancelled
              </button>
              <button
                onclick="useTemplate('rescheduled')"
                class="px-3 py-1.5 text-xs border border-gray-300 rounded-lg hover:bg-gray-50"
              >
                Rescheduled
              </button>
              <button
                onclick="useTemplate('urgent')"
                class="px-3 py-1.5 text-xs border border-gray-300 rounded-lg hover:bg-gray-50"
              >
                Urgent Need
              </button>
              <button
                onclick="useTemplate('thankyou')"
                class="px-3 py-1.5 text-xs border border-gray-300 rounded-lg hover:bg-gray-50"
              >
                Thank You
              </button>
            </div>
          </div>

          <!-- Preview -->
          <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="text-sm font-semibold text-gray-700 mb-2">Preview</h4>
            <div class="bg-white border border-gray-200 rounded-lg p-3">
              <div class="flex items-start gap-3">
                <div
                  class="w-10 h-10 bg-[#2f6e4e] rounded-full flex items-center justify-center text-white font-semibold flex-shrink-0"
                >
                  SK
                </div>
                <div class="flex-1 min-w-0">
                  <p class="font-semibold text-sm text-gray-900">SK Malanday</p>
                  <p id="previewMessage" class="text-sm text-gray-600 mt-1">
                    Your message will appear here...
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Footer -->
        <div class="p-6 border-t bg-gray-50 flex justify-between items-center">
          <button
            onclick="closeNotifyModal()"
            class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-white"
          >
            Cancel
          </button>
          <button
            onclick="sendNotification()"
            class="px-6 py-2 bg-[#2f6e4e] text-white rounded-lg hover:bg-[#2f6e4e] font-medium"
          >
            Send Notification
          </button>
        </div>
      </div>
    </div>

    <!-- Notification Modal -->
    <div
      id="notificationModal"
      class="hidden fixed top-20 right-6 w-96 bg-white rounded-xl shadow-2xl z-50 border border-gray-200"
    >
      <div
        class="p-4 border-b border-gray-200 flex items-center justify-between"
      >
        <h3 class="font-bold text-gray-800">Notifications</h3>
        <button
          onclick="markAllAsRead()"
          class="text-xs text-[#2f6e4e] hover:text-[#2f6e4e] font-medium"
        >
          Mark all as read
        </button>
      </div>
      <div id="notificationList" class="max-h-96 overflow-y-auto">
        <!-- Notifications will be dynamically inserted here -->
      </div>
    </div>

    <script>
      /***********************
       * Projects from Projects Module *
       ***********************/
      const UPLOADED_BANNER = "/mnt/data/Screenshot 2025-11-20 205421.png";

      // Projects data matching the Projects module
      const sampleProjects = [
        {
          id: 1,
          title: "Community Clean-Up Drive 2025: Malanday River Rehabilitation",
          start: "2025-12-02T08:00:00",
          end: "2025-12-02T12:00:00",
          extendedProps: {
            type: "project",
            category: "Environment",
            head: "Andrea Pelias, Kyleen Nicdao",
            status: "Ongoing",
            location: "Malanday River and surrounding areas",
            banner: UPLOADED_BANNER,
            description:
              "A comprehensive environmental initiative focused on rehabilitating the Malanday River system through weekly clean-up activities, waste segregation education, and community involvement.\n\nObjectives:\n• Remove accumulated waste from river and riverbanks\n• Educate residents on proper waste disposal\n• Plant trees along riverbanks\n• Establish monitoring system for illegal dumping\n\nVolunteer Roles Needed:\n• Event Coordinators\n• Documentation Team\n• Logistics Support\n• Community Educators",
            inquiries: [
              {
                id: 101,
                name: "Juan Dela Cruz",
                message: "What time po magsisimula?",
                time: "2h",
                replied: true,
                replies: [
                  {
                    text: "Good day! The clean-up drive will start at 7:00 AM. Please arrive 15 minutes earlier for registration. Thank you!",
                    repliedBy: "Andrea Pelias",
                    repliedAt: "1h",
                  },
                ],
              },
              {
                id: 102,
                name: "Maria Santos",
                message: "Pwede po bang sumama kahit late?",
                time: "5h",
                replied: true,
                replies: [
                  {
                    text: "Hello! Yes, you can join even if you arrive late. However, we encourage everyone to come on time so you won't miss the orientation and safety briefing. See you there!",
                    repliedBy: "Andrea Pelias",
                    repliedAt: "4h",
                  },
                ],
              },
            ],
          },
        },
        {
          id: 2,
          title: "Youth Sports Festival 2025",
          start: "2025-11-25T09:00:00",
          end: "2025-11-25T17:00:00",
          extendedProps: {
            type: "project",
            category: "Sports",
            head: "Kyleen Nicdao",
            status: "Completed",
            location: "Covered Court",
            banner: UPLOADED_BANNER,
            description:
              "A multi-sport festival for barangay youth including basketball and volleyball. Registration required for teams. Food and first aid on site.",
            inquiries: [
              {
                id: 201,
                name: "Mark Rivera",
                message: "Anong uniform ang suot?",
                time: "1d",
                replied: false,
                replies: [],
              },
            ],
          },
        },
        {
          id: 3,
          title: "Scholarship Program Deadline",
          start: "2025-12-15T23:59:00",
          end: "2025-12-15T23:59:00",
          allDay: false,
          extendedProps: {
            type: "deadline",
            category: "Education",
            head: "Andrea Pelias",
            status: "Open",
            location: "SK Office",
            banner: UPLOADED_BANNER,
            description:
              "Support & scholarship application for deserving students. Deadline: December 15, 2025. Submit requirements to the office during office hours.",
            inquiries: [],
          },
        },
      ];

      let calendar;
      let projectsStore = {};

      document.addEventListener("DOMContentLoaded", function () {
        const calendarEl = document.getElementById("calendar");

        sampleProjects.forEach(
          (ev) => (projectsStore[ev.id] = JSON.parse(JSON.stringify(ev)))
        );

        calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: "dayGridMonth",
          height: "auto",
          headerToolbar: {
            left: "prev,next",
            center: "title",
            right: "dayGridMonth,timeGridWeek,timeGridDay",
          },
          events: sampleProjects.map(mapToFcEvent),
          eventClick: handleEventClick,
          eventDidMount: function (info) {
            const hasInq = info.event.extendedProps?.inquiries?.length > 0;
            if (hasInq) {
              const dot = document.createElement("span");
              dot.className =
                "ml-1 inline-block w-2 h-2 bg-red-500 rounded-full";
              info.el.querySelector(".fc-event-title")?.appendChild(dot);
            }
          },
        });

        calendar.render();
        refreshUpcoming();
        attachControls();
      });

      function mapToFcEvent(ev) {
        return {
          id: ev.id,
          title: ev.title,
          start: ev.start,
          end: ev.end,
          allDay: !!ev.allDay,
          extendedProps: ev.extendedProps,
        };
      }

      function handleEventClick(arg) {
        const ev = projectsStore[arg.event.id];
        if (!ev) return;
        openViewModal(ev);
      }

      function openViewModal(ev) {
        showElement("viewModal");
        document.getElementById("viewTitle").textContent = ev.title;
        document.getElementById("viewRange").textContent = `${formatReadable(
          ev.start
        )} — ${formatReadable(ev.end)}`;
        document.getElementById("viewDesc").textContent =
          ev.extendedProps.description || "";
        document.getElementById("viewHead").textContent =
          ev.extendedProps.head || "—";
        document.getElementById("viewStatus").textContent =
          ev.extendedProps.status || "—";
        const inqCount = (ev.extendedProps.inquiries || []).length;
        document.getElementById("viewInquiries").textContent = inqCount;
        document.getElementById("viewStart").textContent = formatReadable(
          ev.start
        );
        document.getElementById("viewEnd").textContent = formatReadable(ev.end);
        document.getElementById("viewLocation").textContent = ev.extendedProps
          .location || "—";
        const typeBadge = document.getElementById("viewTypeBadge");
        typeBadge.textContent = (ev.extendedProps.type || "").toUpperCase();
        if (ev.extendedProps.type) typeBadge.classList.remove("hidden");
        else typeBadge.classList.add("hidden");

        const wrap = document.getElementById("viewBannerWrap");
        wrap.innerHTML = "";
        if (ev.extendedProps.banner) {
          const img = document.createElement("img");
          img.src = ev.extendedProps.banner;
          img.alt = "banner";
          img.className = "w-full h-full object-cover";
          wrap.appendChild(img);
        } else {
          wrap.innerHTML = '<div class="text-sm text-gray-400">No banner</div>';
        }

        document.getElementById("openInquiryBtn").onclick = () =>
          openInquiryModalForEvent(ev.id);
        document.getElementById("viewProjectDetailsBtn").onclick = () => {
          window.location.href = "manage-projects-improved.html";
        };
      }

      function closeViewModal() {
        hideElement("viewModal");
      }

      function openInquiryModalForEvent(eventId) {
        const ev = projectsStore[eventId];
        if (!ev) return;
        showElement("inquiryModal");
        document.getElementById("inquiryEventTitle").textContent = ev.title;
        const list = document.getElementById("inquiryList");
        list.innerHTML = "";
        const inqs = ev.extendedProps.inquiries || [];
        if (!inqs.length) {
          list.innerHTML =
            '<div class="text-sm text-gray-500">No inquiries yet.</div>';
        } else {
          inqs.forEach((q) => {
            const el = document.createElement("div");
            el.className = "border border-gray-200 rounded-lg p-3";
            el.innerHTML = `<div class="flex items-start justify-between">
                         <div><p class="font-semibold">${
                           q.name
                         }</p><p class="text-xs text-gray-600">${
              q.message
            }</p></div>
                         <div class="text-xs text-gray-500">${
                           q.replied ? "Replied" : "Pending"
                         }</div>
                        </div>`;
            list.appendChild(el);
          });
        }
        inquiryState.activeEvent = eventId;
      }

      function closeInquiryModal() {
        hideElement("inquiryModal");
        inquiryState.activeEvent = null;
      }

      const inquiryState = { activeEvent: null };

      function sendReply() {
        const txt = document.getElementById("replyText").value.trim();
        if (!txt) {
          showToast("Reply cannot be empty", "warning");
          return;
        }
        const evId = inquiryState.activeEvent;
        if (!evId) return;
        const ev = projectsStore[evId];
        ev.extendedProps.inquiries = (ev.extendedProps.inquiries || []).map(
          (q) => ({ ...q, replied: true })
        );
        document.getElementById("replyText").value = "";
        showToast("Reply sent (demo) — inquiries marked replied");
        document.getElementById("viewInquiries").textContent =
          ev.extendedProps.inquiries.length;
        refreshUpcoming();
        closeInquiryModal();
      }

      function attachControls() {
        document
          .getElementById("showAllProjects")
          .addEventListener("click", () => {
            window.location.href = "sk-projects.html";
          });
        document
          .getElementById("notifyVols")
          .addEventListener("click", openNotifyModal);
        document
          .getElementById("exportIcsBtn")
          .addEventListener("click", () => showToast("Export iCal (demo)."));

        // Character counter for notification message
        const notifyMsg = document.getElementById("notifyMessage");
        if (notifyMsg) {
          notifyMsg.addEventListener("input", function () {
            const count = this.value.length;
            document.getElementById("charCount").textContent = count;
            document.getElementById("previewMessage").textContent =
              this.value || "Your message will appear here...";
          });
        }
      }

      // Notification Modal Functions
      function openNotifyModal() {
        showElement("notifyModal");
        document.body.classList.add("modal-open");

        // Populate project dropdown
        const projectSelect = document.getElementById("notifyProject");
        projectSelect.innerHTML = '<option value="">All Projects</option>';
        Object.values(projectsStore).forEach((proj) => {
          const option = document.createElement("option");
          option.value = proj.id;
          option.textContent = proj.title;
          projectSelect.appendChild(option);
        });

        updateVolunteerCount();
      }

      function closeNotifyModal() {
        hideElement("notifyModal");
        document.body.classList.remove("modal-open");
        // Reset form
        document.getElementById("notifyProject").value = "";
        document.getElementById("notifyTarget").value = "all";
        document.getElementById("notifyMessage").value = "";
        document.getElementById("charCount").textContent = "0";
        document.getElementById("previewMessage").textContent =
          "Your message will appear here...";
      }

      function updateVolunteerCount() {
        const target = document.getElementById("notifyTarget").value;
        const projectId = document.getElementById("notifyProject").value;

        let count = 0;

        // Calculate based on filters (demo logic)
        if (target === "all") {
          count = 156; // All registered volunteers
        } else if (target === "approved") {
          count = 89;
        } else if (target === "pending") {
          count = 23;
        } else if (target === "project-specific" && projectId) {
          const project = projectsStore[projectId];
          // Mock: count based on project applicants
          count = Math.floor(Math.random() * 30) + 10;
        } else if (target === "project-specific") {
          count = 0;
        }

        document.getElementById(
          "volunteerCount"
        ).textContent = `${count} volunteer${count !== 1 ? "s" : ""}`;
      }

      function useTemplate(type) {
        const templates = {
          reminder:
            "Reminder: Your assigned project is coming up soon! Please confirm your attendance and arrive 15 minutes early for the briefing. See you there!",
          cancelled:
            "Important Notice: Due to unforeseen circumstances, the scheduled event has been cancelled. We apologize for any inconvenience. Please watch for rescheduling updates.",
          rescheduled:
            "Schedule Update: The event has been rescheduled to a new date and time. Please check the updated calendar and confirm your availability. Thank you for your understanding!",
          urgent:
            "Urgent: We need more volunteers for an upcoming event! If you're available and interested, please respond ASAP. Your help would be greatly appreciated!",
          thankyou:
            "Thank you for your dedication and hard work! Your contribution made a real difference in our community. We look forward to working with you again soon!",
        };

        const message = templates[type] || "";
        document.getElementById("notifyMessage").value = message;
        document.getElementById("charCount").textContent = message.length;
        document.getElementById("previewMessage").textContent = message;
      }

      function sendNotification() {
        const projectId = document.getElementById("notifyProject").value;
        const target = document.getElementById("notifyTarget").value;
        const message = document.getElementById("notifyMessage").value.trim();

        if (!message) {
          showToast("Please enter a message", "warning");
          return;
        }

        const volunteerCount =
          document.getElementById("volunteerCount").textContent;
        const projectName = projectId
          ? projectsStore[projectId]?.title
          : "All Projects";

        showToast(`In-App notification sent to ${volunteerCount}`);
        closeNotifyModal();
      }

      function refreshUpcoming() {
        const listEl = document.getElementById("upcomingList");
        listEl.innerHTML = "";
        const now = new Date();
        const in30 = new Date();
        in30.setDate(now.getDate() + 30);
        const upcoming = Object.values(projectsStore)
          .filter(
            (ev) => new Date(ev.start) >= now && new Date(ev.start) <= in30
          )
          .sort((a, b) => new Date(a.start) - new Date(b.start))
          .slice(0, 6);
        if (!upcoming.length) {
          listEl.innerHTML =
            '<li class="text-sm text-gray-500">No upcoming events in the next 30 days.</li>';
        } else {
          upcoming.forEach((ev) => {
            const li = document.createElement("li");
            const count = (ev.extendedProps.inquiries || []).length;
            li.innerHTML = `<div class="flex items-center justify-between gap-2">
                         <div>
                           <div class="text-sm font-semibold text-gray-800">${
                             ev.title
                           }</div>
                           <div class="text-xs text-gray-500">${formatShort(
                             ev.start
                           )} • ${ev.extendedProps.head || "—"}</div>
                         </div>
                        </div>`;
            listEl.appendChild(li);
          });
        }
      }

      function formatReadable(dateStr) {
        if (!dateStr) return "—";
        const d = new Date(dateStr);
        return d.toLocaleString();
      }
      function formatShort(dateStr) {
        if (!dateStr) return "—";
        const d = new Date(dateStr);
        return d.toLocaleDateString(undefined, {
          month: "short",
          day: "numeric",
        });
      }
      function showElement(id) {
        document.getElementById(id).classList.remove("hidden");
      }
      function hideElement(id) {
        document.getElementById(id).classList.add("hidden");
      }

      function showToast(message, type = 'success') {
        const existingToast = document.querySelector('.toast');
        if (existingToast) {
          existingToast.remove();
        }

        const toast = document.createElement('div');
        toast.className = `toast ${type}`;

        const icons = {
          success: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',
          error: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',
          warning: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>',
          info: '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>'
        };

        toast.innerHTML = `
          <div class="toast-icon">${icons[type]}</div>
          <div class="toast-message">${message}</div>
        `;

        const styles = document.createElement('style');
        if (!document.getElementById('toast-styles')) {
          styles.id = 'toast-styles';
          styles.textContent = `
            .toast {
              position: fixed;
              top: 24px;
              right: 24px;
              min-width: 300px;
              max-width: 500px;
              padding: 16px;
              border-radius: 12px;
              box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
              display: flex;
              align-items: center;
              gap: 12px;
              z-index: 10000;
              transform: translateX(400px);
              transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
              font-family: 'Inter', sans-serif;
            }
            .toast.show {
              transform: translateX(0);
            }
            .toast.success {
              background: linear-gradient(135deg, #10b981 0%, #059669 100%);
              color: white;
            }
            .toast.error {
              background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
              color: white;
            }
            .toast.warning {
              background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
              color: white;
            }
            .toast.info {
              background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
              color: white;
            }
            .toast-icon {
              flex-shrink: 0;
              width: 20px;
              height: 20px;
            }
            .toast-message {
              flex: 1;
              font-size: 14px;
              font-weight: 500;
              line-height: 1.5;
            }
          `;
          document.head.appendChild(styles);
        }

        document.body.appendChild(toast);

        setTimeout(() => {
          toast.classList.add('show');
        }, 10);

        setTimeout(() => {
          toast.classList.remove('show');
          setTimeout(() => {
            toast.remove();
          }, 300);
        }, 4000);
      }

      // Notification System
      let notifications = [
        {
          id: 1,
          type: "project_approved",
          title: "Project Approved: Community Clean-Up Drive 2025",
          message: "Your project has been approved by the Barangay Captain and is now Ongoing",
          time: "2 hours ago",
          read: false,
          projectId: 1,
          status: "approved",
        },
        {
          id: 2,
          type: "project_rejected",
          title: "Project Rejected: International Youth Exchange Program",
          message: "Your project has been rejected. Click to view captain's feedback and edit your proposal",
          time: "1 day ago",
          read: false,
          projectId: 4,
          status: "rejected",
        },
        {
          id: 3,
          type: "project_revision",
          title: "Revision Requested: Scholarship Program Deadline",
          message: "The Barangay Captain requested revisions. Click to view feedback and edit your project",
          time: "3 hours ago",
          read: false,
          projectId: 3,
          status: "revision",
        },
        {
          id: 4,
          type: "new_inquiry",
          title: "New Inquiry: Community Clean-Up Drive 2025",
          message: "Juan Dela Cruz posted a new inquiry on your project",
          time: "5 minutes ago",
          read: false,
          projectId: 1,
        },
        {
          id: 5,
          type: "inquiry_reply",
          title: "Inquiry Reply: Youth Sports Festival",
          message: "Maria Santos replied to an inquiry thread",
          time: "1 hour ago",
          read: false,
          projectId: 2,
        },
        {
          id: 6,
          type: "new_announcement",
          title: "New Announcement Posted",
          message: "Kyleen Nicdao posted a new announcement",
          time: "2 hours ago",
          read: false,
          referenceId: 1,
        },
        {
          id: 7,
          type: "new_project",
          title: "New Project: Beach Clean-Up Initiative",
          message: "Andrea Pelias created a new project",
          time: "3 hours ago",
          read: false,
          referenceId: 3,
        },
        {
          id: 8,
          type: "project_application",
          title: "New Application: Community Clean-Up Drive 2025",
          message: "Juan Dela Cruz applied to your project",
          time: "30 minutes ago",
          read: false,
          projectId: 1,
          applicantId: 1,
        },
      ];

      function toggleNotificationModal() {
        const modal = document.getElementById("notificationModal");
        modal.classList.toggle("hidden");
        if (!modal.classList.contains("hidden")) {
          renderNotifications();
        }
      }

      function closeNotificationModal() {
        document.getElementById("notificationModal").classList.add("hidden");
      }

      function updateNotificationCount() {
        const unreadCount = notifications.filter((n) => !n.read).length;
        const badge = document.getElementById("notificationBadge");

        if (unreadCount > 0) {
          badge.textContent = unreadCount > 9 ? "9+" : unreadCount;
          badge.classList.remove("hidden");
        } else {
          badge.classList.add("hidden");
        }
      }

      function getNotificationIcon(type) {
        switch (type) {
          case "new_inquiry":
            return `<svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>`;
          case "inquiry_reply":
            return `<svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path>
            </svg>`;
          case "new_announcement":
            return `<svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"></path>
            </svg>`;
          case "new_project":
            return `<svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>`;
          case "project_application":
            return `<svg class="w-6 h-6 text-[#2f6e4e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
            </svg>`;
          default:
            return "";
        }
      }

      function getNotificationBgColor(type) {
        switch (type) {
          case "new_inquiry":
            return "bg-yellow-50";
          case "inquiry_reply":
            return "bg-yellow-50";
          case "new_announcement":
            return "bg-blue-50";
          case "new_project":
            return "bg-blue-50";
          case "project_application":
            return "bg-[#2f6e4e]/10";
          default:
            return "bg-gray-50";
        }
      }

      function renderNotifications() {
        const notificationList = document.getElementById("notificationList");

        if (notifications.length === 0) {
          notificationList.innerHTML = `
            <div class="p-8 text-center text-gray-500">
              <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
              </svg>
              <p class="font-medium">No notifications</p>
              <p class="text-sm mt-1">You're all caught up!</p>
            </div>
          `;
          return;
        }

        notificationList.innerHTML = notifications
          .map(
            (notif) => `
          <div
            onclick="handleNotificationClick(${notif.id})"
            class="p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition ${
              !notif.read ? getNotificationBgColor(notif.type) : ""
            }"
          >
            <div class="flex items-start space-x-3">
              <div class="flex-shrink-0">
                ${getNotificationIcon(notif.type)}
              </div>
              <div class="flex-1 min-w-0">
                <div class="flex items-start justify-between">
                  <p class="text-sm font-semibold text-gray-800 truncate ${
                    !notif.read ? "font-bold" : ""
                  }">
                    ${notif.title}
                  </p>
                  ${
                    !notif.read
                      ? '<span class="w-2 h-2 bg-[#2f6e4e] rounded-full flex-shrink-0 ml-2 mt-1"></span>'
                      : ""
                  }
                </div>
                <p class="text-xs text-gray-600 mt-1">${notif.message}</p>
                <p class="text-xs text-gray-400 mt-2">${notif.time}</p>
              </div>
            </div>
          </div>
        `
          )
          .join("");
      }

      function handleNotificationClick(notifId) {
        const notif = notifications.find((n) => n.id === notifId);
        if (!notif) return;

        notif.read = true;
        updateNotificationCount();
        closeNotificationModal();

        // Route to appropriate page based on notification type
        if (notif.type === "new_inquiry" || notif.type === "inquiry_reply") {
          window.location.href = `sk-projects.html?projectId=${notif.projectId}&tab=inquiries`;
        } else if (notif.type === "new_announcement") {
          window.location.href = `sk-dashboard.html`;
        } else if (notif.type === "new_project") {
          window.location.href = `sk-projects.html?projectId=${notif.referenceId}`;
        } else if (notif.type === "project_application") {
          window.location.href = `sk-projects.html?projectId=${notif.projectId}&tab=applications&applicantId=${notif.applicantId}`;
        }
      }

      function markAllAsRead() {
        notifications.forEach((n) => (n.read = true));
        updateNotificationCount();
        renderNotifications();
      }

      // Close notification modal when clicking outside
      document.addEventListener("click", function (event) {
        const modal = document.getElementById("notificationModal");
        const notificationButton = event.target.closest(
          'button[onclick="toggleNotificationModal()"]'
        );

        if (
          !modal.contains(event.target) &&
          !notificationButton &&
          !modal.classList.contains("hidden")
        ) {
          closeNotificationModal();
        }
      });

      // Initialize notification count on page load
      updateNotificationCount();

      // Update current date
      function updateCurrentDate() {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const currentDate = new Date().toLocaleDateString('en-US', options);
        const dateElement = document.getElementById('currentDate');
        if (dateElement) {
          dateElement.textContent = currentDate;
        }
      }
      updateCurrentDate();

      // User profile data (in production, this would be fetched from server)
      let userProfile = {
        firstName: "Andrea",
        middleName: "",
        lastName: "Pelias",
        email: "andrea.pelias@malanday.gov.ph",
        position: "SK Chairman",
        address: "",
        contact: "",
        gender: "",
        birthday: ""
      };

      // Profile Modal Functions
      function openProfileModal() {
        // Load profile data into form
        document.getElementById('profileFirstName').value = userProfile.firstName;
        document.getElementById('profileMiddleName').value = userProfile.middleName;
        document.getElementById('profileLastName').value = userProfile.lastName;
        document.getElementById('profileEmail').value = userProfile.email;
        document.getElementById('profilePosition').value = userProfile.position;
        document.getElementById('profileAddress').value = userProfile.address;
        document.getElementById('profileContact').value = userProfile.contact;
        document.getElementById('profileGender').value = userProfile.gender;
        document.getElementById('profileBirthday').value = userProfile.birthday;

        // Load profile picture preview
        const previewDiv = document.getElementById('profilePicturePreview');
        if (userProfile.profilePicture) {
          previewDiv.innerHTML = `<img src="${userProfile.profilePicture}" alt="Profile Picture" class="w-full h-full object-cover rounded-full" />`;
        } else {
          const firstInitial = userProfile.firstName.charAt(0).toUpperCase();
          const lastInitial = userProfile.lastName.charAt(0).toUpperCase();
          previewDiv.innerHTML = `<span id="profileInitials" class="text-white font-bold text-2xl">${firstInitial}${lastInitial}</span>`;
        }

        document.getElementById('profileModal').classList.remove('hidden');
      }

      function closeProfileModal() {
        document.getElementById('profileModal').classList.add('hidden');
      }

      function handleProfilePictureChange(event) {
        const file = event.target.files[0];
        if (!file) return;

        // Validate file type
        if (!file.type.startsWith('image/')) {
          showToast('Please upload an image file', 'error');
          return;
        }

        // Validate file size (max 5MB)
        if (file.size > 5 * 1024 * 1024) {
          showToast('Image size should be less than 5MB', 'error');
          return;
        }

        const reader = new FileReader();
        reader.onload = function(e) {
          const imageData = e.target.result;

          // Store in profile
          userProfile.profilePicture = imageData;

          // Update modal preview
          const previewDiv = document.getElementById('profilePicturePreview');
          previewDiv.innerHTML = `<img src="${imageData}" alt="Profile Picture" class="w-full h-full object-cover rounded-full" />`;

          // Update header avatar
          updateHeaderAvatar();

          showToast('Profile picture uploaded successfully!');
        };
        reader.readAsDataURL(file);
      }

      function updateHeaderAvatar() {
        const headerAvatar = document.querySelector('header .w-10.h-10.bg-[#2f6e4e]');
        if (!headerAvatar) return;

        if (userProfile.profilePicture) {
          headerAvatar.innerHTML = `<img src="${userProfile.profilePicture}" alt="Profile" class="w-full h-full object-cover rounded-full" />`;
        } else {
          const firstInitial = userProfile.firstName.charAt(0).toUpperCase();
          const lastInitial = userProfile.lastName.charAt(0).toUpperCase();
          headerAvatar.innerHTML = `<span class="text-white font-bold">${firstInitial}${lastInitial}</span>`;
        }
      }

      function saveProfile() {
        // Get form values
        userProfile.firstName = document.getElementById('profileFirstName').value;
        userProfile.middleName = document.getElementById('profileMiddleName').value;
        userProfile.lastName = document.getElementById('profileLastName').value;
        userProfile.address = document.getElementById('profileAddress').value;
        userProfile.contact = document.getElementById('profileContact').value;
        userProfile.gender = document.getElementById('profileGender').value;
        userProfile.birthday = document.getElementById('profileBirthday').value;

        // Validation
        if (!userProfile.firstName || !userProfile.lastName) {
          showToast('First name and last name are required', 'warning');
          return;
        }

        // In production, this would save to the server
        console.log('Profile saved:', userProfile);

        // Update header display
        const middleInitial = userProfile.middleName ? ` ${userProfile.middleName.charAt(0)}.` : '';
        const fullName = `${userProfile.firstName}${middleInitial} ${userProfile.lastName}`;
        document.querySelector('header .text-sm.font-medium').textContent = fullName;

        // Update header avatar
        updateHeaderAvatar();

        showToast('Profile updated successfully!');
        closeProfileModal();
      }
    </script>

    <!-- Profile Modal -->
    <div id="profileModal" class="hidden fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50">
      <div class="flex items-center justify-center min-h-screen px-4">
        <div class="relative bg-white rounded-2xl shadow-2xl max-w-2xl w-full">
          <!-- Header -->
          <div class="bg-gradient-to-r from-[#3d8b64] to-[#3d8b64] text-white p-6 rounded-t-2xl">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-4">
                <div class="w-16 h-16 bg-white/20 backdrop-blur rounded-full flex items-center justify-center text-white font-bold text-2xl">
                  AP
                </div>
                <div>
                  <h2 class="text-2xl font-bold">My Profile</h2>
                  <p class="text-[#2f6e4e]/20 text-sm">Manage your account information</p>
                </div>
              </div>
              <button onclick="closeProfileModal()" class="text-white hover:bg-white/20 rounded-lg p-2 transition">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
              </button>
            </div>
          </div>

          <!-- Body -->
          <div class="p-6 space-y-6">
            <!-- Account Info Section -->
            <div>
              <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-[#2f6e4e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                Account Information
              </h3>
              <div class="grid grid-cols-3 gap-4">
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">First Name</label>
                  <input type="text" id="profileFirstName" value="Andrea"
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent" />
                </div>
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Middle Name</label>
                  <input type="text" id="profileMiddleName" placeholder="Optional"
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent" />
                </div>
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Last Name</label>
                  <input type="text" id="profileLastName" value="Pelias"
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent" />
                </div>
              </div>

              <div class="mt-4">
                <label class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                <input type="email" id="profileEmail" value="andrea.pelias@malanday.gov.ph"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 cursor-not-allowed"
                       readonly />
                <p class="text-xs text-gray-500 mt-1">Email cannot be changed. Contact admin if needed.</p>
              </div>

              <div class="mt-4">
                <label class="block text-sm font-semibold text-gray-700 mb-2">Position</label>
                <input type="text" id="profilePosition" value="SK Chairman"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 cursor-not-allowed"
                       readonly />
              </div>
            </div>

            <!-- Personal Info Section -->
            <div class="pt-6 border-t border-gray-200">
              <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-[#2f6e4e]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                </svg>
                Personal Information
              </h3>

              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Complete Address</label>
                  <textarea id="profileAddress" rows="3" placeholder="Enter your complete address"
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent"></textarea>
                </div>

                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Contact Number</label>
                  <input type="tel" id="profileContact" placeholder="e.g., 09171234567"
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent" />
                </div>

                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Gender</label>
                  <select id="profileGender" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent">
                    <option value="">Select gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="non-binary">Non-binary / Gender Neutral</option>
                    <option value="prefer-not-to-say">Prefer not to say</option>
                  </select>
                </div>

                <div>
                  <label class="block text-sm font-semibold text-gray-700 mb-2">Birthday</label>
                  <input type="date" id="profileBirthday"
                         class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#3d8b64] focus:border-transparent" />
                </div>
              </div>
            </div>
          </div>

          <!-- Footer -->
          <div class="sticky bottom-0 bg-gray-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3 border-t">
            <button onclick="closeProfileModal()"
                    class="px-6 py-3 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg font-medium transition">
              Cancel
            </button>
            <button onclick="saveProfile()"
                    class="px-6 py-3 bg-[#2f6e4e] hover:bg-[#2f6e4e] text-white rounded-lg font-medium transition flex items-center gap-2">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              Save Changes
            </button>
          </div>
        </div>
      </div>
    </div>
      <script src="js/mobile-nav.js"></script>
  </body>
</html>
